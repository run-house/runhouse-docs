{"parents": [], "prev": {"link": "../debugging_logging/", "title": "Debugging and Logging"}, "next": {"link": "../data_collection/", "title": "Security and Metadata Collection"}, "title": "Manual Setup and Troubleshooting", "meta": {}, "body": "<section id=\"manual-setup-and-troubleshooting\">\n<h1>Manual Setup and Troubleshooting<a class=\"headerlink\" href=\"#manual-setup-and-troubleshooting\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p>Below we document steps for manually setting up SSH tunnel and syncing files/packages,\nas well as some commonly encountered errors and solutions. Please create an issue on\n<a class=\"reference external\" href=\"https://github.com/run-house/runhouse/issues\">Github</a> or message us on\n<a class=\"reference external\" href=\"https://discord.gg/RnhB6589Hs\">Discord</a> for more support.</p>\n<section id=\"manual-ssh-tunneling\">\n<h2>Manual SSH Tunneling<a class=\"headerlink\" href=\"#manual-ssh-tunneling\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>If you are having trouble forming successful SSH connections with the Runhouse pip package,\nwant more control over SSH tunneling, or want to use latest unreleased features from main,\nyou may perform the following manual setup steps.</p>\n<ol class=\"arabic\">\n<li><p>Install Runhouse on your local box with:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">pip</span> <span class=\"n\">install</span> <span class=\"n\">runhouse</span>  <span class=\"c1\"># latest</span>\n<span class=\"c1\"># or</span>\n<span class=\"n\">pip</span> <span class=\"n\">install</span> <span class=\"n\">git</span><span class=\"o\">+</span><span class=\"n\">https</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">github</span><span class=\"o\">.</span><span class=\"n\">com</span><span class=\"o\">/</span><span class=\"n\">run</span><span class=\"o\">-</span><span class=\"n\">house</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">.</span><span class=\"n\">git</span>  <span class=\"c1\"># main branch</span>\n</pre></div>\n</div>\n</li>\n<li><p>SSH into your server with a tunnel. You can use a different local or remote port here as well;\nsteps 5 and 6 contain additional info for setting up your port.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">ssh</span> <span class=\"n\">user</span><span class=\"nd\">@host</span> <span class=\"o\">-</span><span class=\"n\">L</span> <span class=\"mi\">50052</span><span class=\"p\">:</span><span class=\"n\">localhost</span><span class=\"p\">:</span><span class=\"mi\">50052</span>\n</pre></div>\n</div>\n</li>\n<li><p>Install Runhouse on the remote box using the same command as in step 1:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">pip</span> <span class=\"n\">install</span> <span class=\"n\">runhouse</span>  <span class=\"c1\"># latest</span>\n<span class=\"c1\"># or</span>\n<span class=\"n\">pip</span> <span class=\"n\">install</span> <span class=\"n\">git</span><span class=\"o\">+</span><span class=\"n\">https</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">github</span><span class=\"o\">.</span><span class=\"n\">com</span><span class=\"o\">/</span><span class=\"n\">run</span><span class=\"o\">-</span><span class=\"n\">house</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">.</span><span class=\"n\">git</span>  <span class=\"c1\"># main branch</span>\n</pre></div>\n</div>\n</li>\n<li><p>Start Ray on the remote box:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">ray</span> <span class=\"n\">start</span> <span class=\"o\">--</span><span class=\"n\">head</span>\n</pre></div>\n</div>\n<ul class=\"simple\">\n<li><p>If you receive an error <code class=\"docutils literal notranslate\"><span class=\"pre\">\u201cWARNING:</span> <span class=\"pre\">The</span> <span class=\"pre\">scripts</span> <span class=\"pre\">ray,</span> <span class=\"pre\">rllib,</span> <span class=\"pre\">serve</span> <span class=\"pre\">and</span> <span class=\"pre\">tune</span> <span class=\"pre\">are</span> <span class=\"pre\">installed</span>\n<span class=\"pre\">in</span> <span class=\"pre\">'/home/user/.local/bin'</span> <span class=\"pre\">which</span> <span class=\"pre\">is</span> <span class=\"pre\">not</span> <span class=\"pre\">on</span> <span class=\"pre\">PATH.\u201d</span></code>, you may need to add the destination of the installed packages\nto the path, e.g. <code class=\"docutils literal notranslate\"><span class=\"pre\">PATH=$PATH:/home/user/.local/bin</span></code>.</p></li>\n</ul>\n</li>\n<li><p>Start the Runhouse server on the remote box:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">runhouse</span> <span class=\"n\">start</span>\n</pre></div>\n</div>\n<p>If you previously already had a version of Runhouse installed and started, you will need to run:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">runhouse</span> <span class=\"n\">restart</span>\n</pre></div>\n</div>\n<ul class=\"simple\">\n<li><p>To exit out of the process and run it in the background instead, you can do <code class=\"docutils literal notranslate\"><span class=\"pre\">Ctrl+C</span></code> and then <code class=\"docutils literal notranslate\"><span class=\"pre\">runhouse</span> <span class=\"pre\">start</span> <span class=\"pre\">--screen</span></code>.\nPlease first make sure regular <code class=\"docutils literal notranslate\"><span class=\"pre\">runhouse</span> <span class=\"pre\">start</span></code> does not error out prior to testing it out in a screen.</p></li>\n<li><p>If you previously specified a custom port in step 2, add <code class=\"docutils literal notranslate\"><span class=\"pre\">--port</span> <span class=\"pre\">&lt;my_port&gt;</span></code> to the runhouse start command.</p></li>\n</ul>\n</li>\n<li><p>Initialize the Runhouse cluster in Python as follows. Make sure to use <code class=\"docutils literal notranslate\"><span class=\"pre\">localhost</span></code> as the cluster address rather than the true IP,\nas you manually created the tunnel above.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">gpu</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">cluster</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">&#39;rh-a10x&#39;</span><span class=\"p\">,</span> <span class=\"n\">host</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s2\">&quot;localhost&quot;</span><span class=\"p\">],</span> <span class=\"n\">ssh_creds</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s2\">&quot;ssh_user&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;user&quot;</span><span class=\"p\">})</span>\n</pre></div>\n</div>\n<ul class=\"simple\">\n<li><p>To specify another port, you can pass in <code class=\"docutils literal notranslate\"><span class=\"pre\">host=[&quot;localhost:&lt;my_port&gt;&quot;]</span></code></p></li>\n<li><p>If your remote box already has a port open to http traffic, you can directly use it instead of forming a new tunnel.\nPass in <code class=\"docutils literal notranslate\"><span class=\"pre\">host=[&quot;&lt;my</span> <span class=\"pre\">ip&gt;:&lt;my</span> <span class=\"pre\">port&gt;&quot;]</span></code>.</p></li>\n</ul>\n</li>\n</ol>\n</section>\n<section id=\"manual-file-and-package-syncing\">\n<h2>Manual File and Package Syncing<a class=\"headerlink\" href=\"#manual-file-and-package-syncing\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>If you are running into an rsync or module not found error, you can work around by manually syncing over local files or\ninstalling any packages on your remote box.</p>\n<ol class=\"arabic\">\n<li><p>To sync over the local folder (e.g. <code class=\"docutils literal notranslate\"><span class=\"pre\">tutorials</span></code>) to remote. Not the trailing slash <code class=\"docutils literal notranslate\"><span class=\"pre\">/</span></code> at the end of the local directory\nto prevent an additional level of folder nesting on the remote cluster. Now is also a good time to install any packages on the remote box,\nincluding <code class=\"docutils literal notranslate\"><span class=\"pre\">requirements.txt</span></code>.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">rsync</span> <span class=\"o\">-</span><span class=\"n\">a</span> <span class=\"n\">tutorials</span><span class=\"o\">/</span> <span class=\"n\">user</span><span class=\"o\">@</span><span class=\"mf\">216.153.62.74</span><span class=\"p\">:</span><span class=\"n\">tutorials</span>\n</pre></div>\n</div>\n<p>To ensure Runhouse doesn\u2019t try to resync over your code again, pass in an empty env object, <code class=\"docutils literal notranslate\"><span class=\"pre\">env=rh.Env()</span></code>,\nwhen sending functions or modules to the cluster.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">generate_gpu</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">function</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"o\">=</span><span class=\"n\">sd_generate</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">gpu</span><span class=\"p\">,</span> <span class=\"n\">env</span><span class=\"o\">=</span><span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">Env</span><span class=\"p\">())</span>\n</pre></div>\n</div>\n</li>\n<li><p>If you\u2019re encountering a Module not found error, you may need to pass a Runhouse package object pointing to the\npackage in the remote filesystem into your Env so the server can find the module properly. You can do that like so:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">my_env</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">Env</span><span class=\"p\">(</span><span class=\"n\">workdir</span><span class=\"o\">=</span><span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">Package</span><span class=\"p\">(</span><span class=\"n\">path</span><span class=\"o\">=</span><span class=\"s2\">&quot;tutorials&quot;</span><span class=\"p\">,</span> <span class=\"n\">system</span><span class=\"o\">=</span><span class=\"n\">gpu</span><span class=\"p\">,</span> <span class=\"n\">install_method</span><span class=\"o\">=</span><span class=\"s2\">&quot;reqs&quot;</span><span class=\"p\">))</span>\n<span class=\"n\">generate_gpu</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">function</span><span class=\"p\">(</span><span class=\"n\">fn</span><span class=\"o\">=</span><span class=\"n\">sd_generate</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">gpu</span><span class=\"p\">,</span> <span class=\"n\">env</span><span class=\"o\">=</span><span class=\"n\">my_env</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<ul class=\"simple\">\n<li><p><code class=\"docutils literal notranslate\"><span class=\"pre\">install_method</span></code> can be <code class=\"docutils literal notranslate\"><span class=\"pre\">local</span></code> (to skip install), <code class=\"docutils literal notranslate\"><span class=\"pre\">pip</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">conda</span></code>, or <code class=\"docutils literal notranslate\"><span class=\"pre\">reqs</span></code>\n(pip installs requirements.txt)</p></li>\n</ul>\n</li>\n</ol>\n</section>\n<section id=\"common-errors\">\n<h2>Common Errors<a class=\"headerlink\" href=\"#common-errors\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>Q: I\u2019m running into the following error: <code class=\"docutils literal notranslate\"><span class=\"pre\">ImportError:</span> <span class=\"pre\">Failed</span> <span class=\"pre\">to</span> <span class=\"pre\">import</span> <span class=\"pre\">grpc</span> <span class=\"pre\">on</span> <span class=\"pre\">Apple</span> <span class=\"pre\">Silicon.</span></code></p>\n<blockquote>\n<div><p>Please run <code class=\"docutils literal notranslate\"><span class=\"pre\">pip</span> <span class=\"pre\">uninstall</span> <span class=\"pre\">grpcio;</span> <span class=\"pre\">conda</span> <span class=\"pre\">install</span> <span class=\"pre\">grpcio</span></code>, then rerun your code. This is due to the Ray/grpcio\ncompatibility on Apple Silicon during setup.</p>\n</div></blockquote>\n<p>Q: I\u2019m running into an OpenSSL error.</p>\n<blockquote>\n<div><p>Please run <code class=\"docutils literal notranslate\"><span class=\"pre\">pip</span> <span class=\"pre\">install</span> <span class=\"pre\">pip</span> <span class=\"pre\">--upgrade;</span> <span class=\"pre\">pip</span> <span class=\"pre\">install</span> <span class=\"pre\">pyopenssl</span> <span class=\"pre\">--upgrade</span></code>.</p>\n</div></blockquote>\n<p>Q: I\u2019m running into an rsync error.</p>\n<blockquote>\n<div><p>Rsync is finicky and we are working to support more reliable file syncing. In the meantime, please refer to the\nManual Package syncing instructions above. It is also worth noting that rsync will throw an error if <code class=\"docutils literal notranslate\"><span class=\"pre\">.bashrc</span></code>\noutputs anything to the terminal. See <a class=\"reference external\" href=\"https://github.com/run-house/runhouse/issues/91\">Issue</a>.</p>\n</div></blockquote>\n</section>\n</section>\n\n    <script type=\"text/x-thebe-config\">\n    {\n        requestKernel: true,\n        binderOptions: {\n            repo: \"binder-examples/jupyter-stacks-datascience\",\n            ref: \"master\",\n        },\n        codeMirrorConfig: {\n            theme: \"abcdef\",\n            mode: \"python\"\n        },\n        kernelOptions: {\n            name: \"python3\",\n            path: \"./.\"\n        },\n        predefinedOutput: true\n    }\n    </script>\n    <script>kernelName = 'python3'</script>", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["data_collection", "Security and Metadata Collection", "N", "next"], ["debugging_logging", "Debugging and Logging", "P", "previous"]], "sourcename": "troubleshooting.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Manual Setup and Troubleshooting</a><ul>\n<li><a class=\"reference internal\" href=\"#manual-ssh-tunneling\">Manual SSH Tunneling</a></li>\n<li><a class=\"reference internal\" href=\"#manual-file-and-package-syncing\">Manual File and Package Syncing</a></li>\n<li><a class=\"reference internal\" href=\"#common-errors\">Common Errors</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "globaltoc": "<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Getting Started</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick_start/\">Quick Start Guide</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"architecture/\">Architecture Overview</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api_tutorials/\">API Tutorials</a><ul>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"tutorials/api/compute/\">Compute: Clusters, Functions, Packages, &amp; Envs</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"tutorials/api/data/\">Data: Folders, Tables, &amp; Blobs</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"tutorials/api/accessibility/\">Accessibility: Resource and Secrets Management</a></li>\n</ul>\n</li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">API Reference</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/python/\">Python API</a><ul>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/resource/\">Resource</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/function/\">Function</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/cluster/\">Cluster</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/env/\">Env</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/package/\">Package</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/run/\">Run</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/module/\">Module</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/folder/\">Folder</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/table/\">Table</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/blob/\">Blob</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/secrets/\">Secrets</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/login/\">Login/Logout</a></li>\n</ul>\n</li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/cli/\">Command Line Interface</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Usage Examples</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/examples/inference/\">Inference: Stable Diffusion and FLAN-T5</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/examples/training/\">Training: Transformers</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/examples/distributed/\">Distributed: HF Accelerate</a></li>\n<li class=\"toctree-l1\"><a class=\"reference external\" href=\"https://github.com/run-house/funhouse/tree/main/bert_pipeline\">Pipelining: BERT</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Additional Resources</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"debugging_logging/\">Debugging and Logging</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"troubleshooting/\">Manual Setup and Troubleshooting</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"data_collection/\">Security and Metadata Collection</a></li>\n<li class=\"toctree-l1\"><a class=\"reference external\" href=\"https://github.com/run-house/runhouse\">Source Code</a></li>\n<li class=\"toctree-l1\"><a class=\"reference external\" href=\"https://api.run.house/docs\">REST API Guide</a></li>\n<li class=\"toctree-l1\"><a class=\"reference external\" href=\"https://www.run.house/dashboard\">Dashboard</a></li>\n<li class=\"toctree-l1\"><a class=\"reference external\" href=\"https://github.com/run-house/funhouse\">Funhouse</a></li>\n</ul>\n", "current_page_name": "troubleshooting", "sidebars": ["about.html", "navigation.html", "relations.html", "searchbox.html", "donate.html"], "customsidebar": null, "alabaster_version": "0.7.13"}