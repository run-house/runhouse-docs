{"parents": [], "prev": null, "next": null, "title": "Data: Folders, Tables, &amp; Blobs", "meta": {}, "body": "<section id=\"data-folders-tables-blobs\">\n<h1>Data: Folders, Tables, &amp; Blobs<a class=\"headerlink\" href=\"#data-folders-tables-blobs\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p><a href=\"https://colab.research.google.com/github/run-house/notebooks/blob/stable/docs/api_basics/data.ipynb\">\n<img height=\"20px\" width=\"117px\" src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a></p><p>Runhouse has several abstractions to provide a simple interface for\nstoring, recalling, and moving data between the user\u2019s laptop, remote\ncompute, cloud storage, and specialized storage (e.g.\u00a0data warehouses).</p>\n<p>The Folder, Table, and Blob APIs provide least-common-denominator APIs\nacross providers, allowing users to easily specify the actions they want\nto take on the data without needed to dig into provider-specific APIs.</p>\n<section id=\"install-runhouse-and-setup-cluster\">\n<h2>Install Runhouse and Setup Cluster<a class=\"headerlink\" href=\"#install-runhouse-and-setup-cluster\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!pip install &quot;runhouse[aws]&quot;\n</pre></div>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>import runhouse as rh\n</pre></div>\n</div>\n<p>Optionally, login to Runhouse to sync credentials.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!runhouse login\n</pre></div>\n</div>\n<p>We also construct a Runhouse cluster object that we will use throughout\nthe tutorial. We won\u2019t go in depth about clusters in this tutorial, but\nyou can refer to Getting Started for setup instructions, or the Compute\nAPI tutorial for a more in-depth walkthrough of clusters.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster = rh.ondemand_cluster(\n              name=&quot;cpu-cluster&quot;,\n              instance_type=&quot;CPU:8&quot;,\n              provider=&quot;cheapest&quot;,       # &quot;AWS&quot;, &quot;GCP&quot;, &quot;Azure&quot;, &quot;Lambda&quot;, or &quot;cheapest&quot; (default)\n              autostop_mins=60,          # Optional, defaults to default_autostop_mins; -1 suspends autostop\n          )\ncluster.up()\n</pre></div>\n</div>\n</section>\n<section id=\"folders\">\n<h2>Folders<a class=\"headerlink\" href=\"#folders\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>The Runhouse Folder API allows for creating references to folders, and\nsyncing them between local, remote clusters, or file storage (S3, GS,\nAzure).</p>\n<p>Let\u2019s construct a sample dummy folder locally, that we\u2019ll use to\ndemonstrate.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>import os\nfolder_name = &quot;sample_folder&quot;\nos.makedirs(folder_name, exist_ok=True)\n\nfor i in range(5):\n  with open(f&#39;{folder_name}/{i}.txt&#39;, &#39;w&#39;) as f:\n      f.write(&#39;i&#39;)\n\nlocal_path = f&quot;{os.getcwd()}/{folder_name}&quot;\n</pre></div>\n</div>\n<p>To create a folder object, use the <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.folder()</span></code> factory function, and\nuse <code class=\"docutils literal notranslate\"><span class=\"pre\">.to()</span></code> to send the folder to a remote cluster.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>local_folder = rh.folder(path=f&quot;{os.getcwd()}/{folder_name}&quot;)\ncluster_folder = local_folder.to(system=cluster, path=folder_name)\n\ncluster.run([f&quot;ls {folder_name}&quot;])\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">29</span> <span class=\"mi\">19</span><span class=\"p\">:</span><span class=\"mi\">45</span><span class=\"p\">:</span><span class=\"mf\">52.597164</span> <span class=\"o\">|</span> <span class=\"n\">Copying</span> <span class=\"n\">folder</span> <span class=\"kn\">from</span> <span class=\"nn\">file</span><span class=\"p\">:</span><span class=\"o\">///</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">caroline</span><span class=\"o\">/</span><span class=\"n\">Documents</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"n\">docs</span><span class=\"o\">/</span><span class=\"n\">notebooks</span><span class=\"o\">/</span><span class=\"n\">basics</span><span class=\"o\">/</span><span class=\"n\">sample_folder</span> <span class=\"n\">to</span><span class=\"p\">:</span> <span class=\"n\">cpu</span><span class=\"o\">-</span><span class=\"n\">cluster</span><span class=\"p\">,</span> <span class=\"k\">with</span> <span class=\"n\">path</span><span class=\"p\">:</span> <span class=\"n\">sample_folder</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">29</span> <span class=\"mi\">19</span><span class=\"p\">:</span><span class=\"mi\">45</span><span class=\"p\">:</span><span class=\"mf\">54.633598</span> <span class=\"o\">|</span> <span class=\"n\">Running</span> <span class=\"n\">command</span> <span class=\"n\">on</span> <span class=\"n\">cpu</span><span class=\"o\">-</span><span class=\"n\">cluster</span><span class=\"p\">:</span> <span class=\"n\">ls</span> <span class=\"n\">sample_folder</span>\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"mf\">0.</span><span class=\"n\">txt</span>\n<span class=\"mf\">1.</span><span class=\"n\">txt</span>\n<span class=\"mf\">2.</span><span class=\"n\">txt</span>\n<span class=\"mf\">3.</span><span class=\"n\">txt</span>\n<span class=\"mf\">4.</span><span class=\"n\">txt</span>\n</pre></div>\n</div>\n<pre class=\"code-output literal-block\">[(0, '0.txtn1.txtn2.txtn3.txtn4.txtn', '')]</pre>\n<p>You can also send the folder to file storage, such as S3, GS, and Azure.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>s3_folder = local_folder.to(system=&quot;s3&quot;)\ns3_folder.ls(full_paths=False)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">29</span> <span class=\"mi\">19</span><span class=\"p\">:</span><span class=\"mi\">47</span><span class=\"p\">:</span><span class=\"mf\">47.618511</span> <span class=\"o\">|</span> <span class=\"n\">Copying</span> <span class=\"n\">folder</span> <span class=\"kn\">from</span> <span class=\"nn\">file</span><span class=\"p\">:</span><span class=\"o\">///</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">caroline</span><span class=\"o\">/</span><span class=\"n\">Documents</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"n\">docs</span><span class=\"o\">/</span><span class=\"n\">notebooks</span><span class=\"o\">/</span><span class=\"n\">basics</span><span class=\"o\">/</span><span class=\"n\">sample_folder</span> <span class=\"n\">to</span><span class=\"p\">:</span> <span class=\"n\">s3</span><span class=\"p\">,</span> <span class=\"k\">with</span> <span class=\"n\">path</span><span class=\"p\">:</span> <span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">-</span><span class=\"n\">folder</span><span class=\"o\">/</span><span class=\"n\">a6f195296945409da432b2981f984ae7</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">29</span> <span class=\"mi\">19</span><span class=\"p\">:</span><span class=\"mi\">47</span><span class=\"p\">:</span><span class=\"mf\">47.721743</span> <span class=\"o\">|</span> <span class=\"n\">Found</span> <span class=\"n\">credentials</span> <span class=\"ow\">in</span> <span class=\"n\">shared</span> <span class=\"n\">credentials</span> <span class=\"n\">file</span><span class=\"p\">:</span> <span class=\"o\">~/.</span><span class=\"n\">aws</span><span class=\"o\">/</span><span class=\"n\">credentials</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">29</span> <span class=\"mi\">19</span><span class=\"p\">:</span><span class=\"mi\">47</span><span class=\"p\">:</span><span class=\"mf\">48.796181</span> <span class=\"o\">|</span> <span class=\"n\">Found</span> <span class=\"n\">credentials</span> <span class=\"ow\">in</span> <span class=\"n\">shared</span> <span class=\"n\">credentials</span> <span class=\"n\">file</span><span class=\"p\">:</span> <span class=\"o\">~/.</span><span class=\"n\">aws</span><span class=\"o\">/</span><span class=\"n\">credentials</span>\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"p\">[</span><span class=\"s1\">&#39;0.txt&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;1.txt&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;2.txt&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;3.txt&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;4.txt&#39;</span><span class=\"p\">]</span>\n</pre></div>\n</div>\n<p>Similarly, you can send folders from a cluster to file storage, cluster\nto cluster, or file storage to file storage. These are all done without\nbouncing the folder off local.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster_folder.to(system=another_cluster)  # cluster to cluster\ncluster_folder.to(system=&quot;s3&quot;)             # cluster to fs\ns3_folder.to(system=cluster)               # fs to cluster\ns3_folder.to(system=&quot;gs&quot;)                  # fs to fs\n</pre></div>\n</div>\n</section>\n<section id=\"tables\">\n<h2>Tables<a class=\"headerlink\" href=\"#tables\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>The Runhouse Table API allows for abstracting tabular data storage, and\nsupports interfaces for HuggingFace, Dask, Pandas, Rapids, and Ray\ntables (more in progress!).</p>\n<p>These can be synced and written down to local, remote clusters, or file\nstorage (S3, GS, Azure).</p>\n<p>Let\u2019s step through an example using a Pandas table we upload to our s3\nbucket using Runhouse.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>import pandas as pd\ndf = pd.DataFrame(\n        {&quot;id&quot;: [1, 2, 3, 4, 5, 6], &quot;grade&quot;: [&quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;a&quot;, &quot;a&quot;, &quot;e&quot;]}\n    )\n\ntable_name = &quot;sample_table&quot;\npath = &quot;/runhouse-table/sample_table&quot;\nrh_table = rh.table(\n    data=df, name=table_name, path=path, system=&quot;s3&quot;, mkdir=True\n).write().save()\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">29</span> <span class=\"mi\">19</span><span class=\"p\">:</span><span class=\"mi\">55</span><span class=\"p\">:</span><span class=\"mf\">29.834000</span> <span class=\"o\">|</span> <span class=\"n\">Found</span> <span class=\"n\">credentials</span> <span class=\"ow\">in</span> <span class=\"n\">shared</span> <span class=\"n\">credentials</span> <span class=\"n\">file</span><span class=\"p\">:</span> <span class=\"o\">~/.</span><span class=\"n\">aws</span><span class=\"o\">/</span><span class=\"n\">credentials</span>\n</pre></div>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>rh_table.data\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span> <span class=\"nb\">id</span> <span class=\"n\">grade</span>\n  <span class=\"mi\">1</span>     <span class=\"n\">a</span>\n  <span class=\"mi\">2</span>     <span class=\"n\">b</span>\n  <span class=\"mi\">3</span>     <span class=\"n\">b</span>\n  <span class=\"mi\">4</span>     <span class=\"n\">a</span>\n  <span class=\"mi\">5</span>     <span class=\"n\">a</span>\n  <span class=\"mi\">6</span>     <span class=\"n\">e</span>\n</pre></div>\n</div>\n<p>To sync over and save the table to a remote cluster, or to local\n(\u201chere\u201d):</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster_table = rh_table.to(cluster)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">29</span> <span class=\"mi\">19</span><span class=\"p\">:</span><span class=\"mi\">59</span><span class=\"p\">:</span><span class=\"mf\">39.456856</span> <span class=\"o\">|</span> <span class=\"n\">Copying</span> <span class=\"n\">folder</span> <span class=\"kn\">from</span> <span class=\"nn\">s3</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">runhouse</span><span class=\"o\">-</span><span class=\"n\">table</span><span class=\"o\">/</span><span class=\"n\">sample_table</span> <span class=\"n\">to</span><span class=\"p\">:</span> <span class=\"n\">cpu</span><span class=\"o\">-</span><span class=\"n\">cluster</span><span class=\"p\">,</span> <span class=\"k\">with</span> <span class=\"n\">path</span><span class=\"p\">:</span> <span class=\"o\">~/.</span><span class=\"n\">cache</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"mi\">82</span><span class=\"n\">d19ef56425409fb92e5d4dfcd389e2</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">29</span> <span class=\"mi\">19</span><span class=\"p\">:</span><span class=\"mi\">59</span><span class=\"p\">:</span><span class=\"mf\">39.458405</span> <span class=\"o\">|</span> <span class=\"n\">Running</span> <span class=\"n\">command</span> <span class=\"n\">on</span> <span class=\"n\">cpu</span><span class=\"o\">-</span><span class=\"n\">cluster</span><span class=\"p\">:</span> <span class=\"n\">aws</span> <span class=\"o\">--</span><span class=\"n\">version</span> <span class=\"o\">&gt;/</span><span class=\"n\">dev</span><span class=\"o\">/</span><span class=\"n\">null</span> <span class=\"mi\">2</span><span class=\"o\">&gt;&amp;</span><span class=\"mi\">1</span> <span class=\"o\">||</span> <span class=\"n\">pip3</span> <span class=\"n\">install</span> <span class=\"n\">awscli</span> <span class=\"o\">&amp;&amp;</span> <span class=\"n\">aws</span> <span class=\"n\">s3</span> <span class=\"n\">sync</span> <span class=\"o\">--</span><span class=\"n\">no</span><span class=\"o\">-</span><span class=\"n\">follow</span><span class=\"o\">-</span><span class=\"n\">symlinks</span> <span class=\"n\">s3</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">runhouse</span><span class=\"o\">-</span><span class=\"n\">table</span><span class=\"o\">/</span><span class=\"n\">sample_table</span> <span class=\"o\">~/.</span><span class=\"n\">cache</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"mi\">82</span><span class=\"n\">d19ef56425409fb92e5d4dfcd389e2</span>\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">download</span><span class=\"p\">:</span> <span class=\"n\">s3</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">runhouse</span><span class=\"o\">-</span><span class=\"n\">table</span><span class=\"o\">/</span><span class=\"n\">sample_table</span><span class=\"o\">/</span><span class=\"n\">d68a64f755014c049b6e97b120db5d0f</span><span class=\"o\">.</span><span class=\"n\">parquet</span> <span class=\"n\">to</span> <span class=\"o\">.</span><span class=\"n\">cache</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"mi\">82</span><span class=\"n\">d19ef56425409fb92e5d4dfcd389e2</span><span class=\"o\">/</span><span class=\"n\">d68a64f755014c049b6e97b120db5d0f</span><span class=\"o\">.</span><span class=\"n\">parquet</span>\n<span class=\"n\">download</span><span class=\"p\">:</span> <span class=\"n\">s3</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">runhouse</span><span class=\"o\">-</span><span class=\"n\">table</span><span class=\"o\">/</span><span class=\"n\">sample_table</span><span class=\"o\">/</span><span class=\"n\">ebf7bbc1b22e4172b162b723b4b234f2</span><span class=\"o\">.</span><span class=\"n\">parquet</span> <span class=\"n\">to</span> <span class=\"o\">.</span><span class=\"n\">cache</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"mi\">82</span><span class=\"n\">d19ef56425409fb92e5d4dfcd389e2</span><span class=\"o\">/</span><span class=\"n\">ebf7bbc1b22e4172b162b723b4b234f2</span><span class=\"o\">.</span><span class=\"n\">parquet</span>\n<span class=\"n\">download</span><span class=\"p\">:</span> <span class=\"n\">s3</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">runhouse</span><span class=\"o\">-</span><span class=\"n\">table</span><span class=\"o\">/</span><span class=\"n\">sample_table</span><span class=\"o\">/</span><span class=\"mi\">53</span><span class=\"n\">d00aa5fa2148dd9f4d9836f7b6a9be</span><span class=\"o\">.</span><span class=\"n\">parquet</span> <span class=\"n\">to</span> <span class=\"o\">.</span><span class=\"n\">cache</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"mi\">82</span><span class=\"n\">d19ef56425409fb92e5d4dfcd389e2</span><span class=\"o\">/</span><span class=\"mi\">53</span><span class=\"n\">d00aa5fa2148dd9f4d9836f7b6a9be</span><span class=\"o\">.</span><span class=\"n\">parquet</span>\n<span class=\"n\">download</span><span class=\"p\">:</span> <span class=\"n\">s3</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">runhouse</span><span class=\"o\">-</span><span class=\"n\">table</span><span class=\"o\">/</span><span class=\"n\">sample_table</span><span class=\"o\">/</span><span class=\"mi\">2</span><span class=\"n\">d0aed0ba49d42509ae9124368a74323</span><span class=\"o\">.</span><span class=\"n\">parquet</span> <span class=\"n\">to</span> <span class=\"o\">.</span><span class=\"n\">cache</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"mi\">82</span><span class=\"n\">d19ef56425409fb92e5d4dfcd389e2</span><span class=\"o\">/</span><span class=\"mi\">2</span><span class=\"n\">d0aed0ba49d42509ae9124368a74323</span><span class=\"o\">.</span><span class=\"n\">parquet</span>\n<span class=\"n\">download</span><span class=\"p\">:</span> <span class=\"n\">s3</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">runhouse</span><span class=\"o\">-</span><span class=\"n\">table</span><span class=\"o\">/</span><span class=\"n\">sample_table</span><span class=\"o\">/</span><span class=\"n\">ea3841db70874ee7aade6ff1299325c5</span><span class=\"o\">.</span><span class=\"n\">parquet</span> <span class=\"n\">to</span> <span class=\"o\">.</span><span class=\"n\">cache</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"mi\">82</span><span class=\"n\">d19ef56425409fb92e5d4dfcd389e2</span><span class=\"o\">/</span><span class=\"n\">ea3841db70874ee7aade6ff1299325c5</span><span class=\"o\">.</span><span class=\"n\">parquet</span>\n<span class=\"n\">download</span><span class=\"p\">:</span> <span class=\"n\">s3</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">runhouse</span><span class=\"o\">-</span><span class=\"n\">table</span><span class=\"o\">/</span><span class=\"n\">sample_table</span><span class=\"o\">/</span><span class=\"n\">e7a7dce218054b6aa2b0853c12afe952</span><span class=\"o\">.</span><span class=\"n\">parquet</span> <span class=\"n\">to</span> <span class=\"o\">.</span><span class=\"n\">cache</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"mi\">82</span><span class=\"n\">d19ef56425409fb92e5d4dfcd389e2</span><span class=\"o\">/</span><span class=\"n\">e7a7dce218054b6aa2b0853c12afe952</span><span class=\"o\">.</span><span class=\"n\">parquet</span>\n</pre></div>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>local_table = rh_table.to(&#39;here&#39;)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">29</span> <span class=\"mi\">19</span><span class=\"p\">:</span><span class=\"mi\">59</span><span class=\"p\">:</span><span class=\"mf\">49.336813</span> <span class=\"o\">|</span> <span class=\"n\">Copying</span> <span class=\"n\">folder</span> <span class=\"kn\">from</span> <span class=\"nn\">s3</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">runhouse</span><span class=\"o\">-</span><span class=\"n\">table</span><span class=\"o\">/</span><span class=\"n\">sample_table</span> <span class=\"n\">to</span><span class=\"p\">:</span> <span class=\"n\">file</span><span class=\"p\">,</span> <span class=\"k\">with</span> <span class=\"n\">path</span><span class=\"p\">:</span> <span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">caroline</span><span class=\"o\">/</span><span class=\"n\">Documents</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"n\">docs</span><span class=\"o\">/</span><span class=\"n\">notebooks</span><span class=\"o\">/</span><span class=\"n\">basics</span><span class=\"o\">/</span><span class=\"n\">sample_table</span>\n</pre></div>\n</div>\n<p>To stream batches of the table, we reload the table object, but with an\niterable <code class=\"docutils literal notranslate\"><span class=\"pre\">.data</span></code> field, using the <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.table</span></code> constructor and passing\nin the name.</p>\n<p>Note that you can\u2019t directly do this with the original table object, as\nits <code class=\"docutils literal notranslate\"><span class=\"pre\">.data</span></code> field is the original <code class=\"docutils literal notranslate\"><span class=\"pre\">data</span></code> passed in, and not\nnecessarily in an iterable format.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>reloaded_table = rh.table(name=table_name)\n</pre></div>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>batches = reloaded_table.stream(batch_size=2)\nfor batch in batches:\n    print(batch)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span>   <span class=\"nb\">id</span> <span class=\"n\">grade</span>\n<span class=\"mi\">0</span>   <span class=\"mi\">1</span>     <span class=\"n\">a</span>\n<span class=\"mi\">1</span>   <span class=\"mi\">2</span>     <span class=\"n\">b</span>\n   <span class=\"nb\">id</span> <span class=\"n\">grade</span>\n<span class=\"mi\">0</span>   <span class=\"mi\">3</span>     <span class=\"n\">b</span>\n<span class=\"mi\">1</span>   <span class=\"mi\">4</span>     <span class=\"n\">a</span>\n   <span class=\"nb\">id</span> <span class=\"n\">grade</span>\n<span class=\"mi\">0</span>   <span class=\"mi\">5</span>     <span class=\"n\">a</span>\n<span class=\"mi\">1</span>   <span class=\"mi\">6</span>     <span class=\"n\">e</span>\n</pre></div>\n</div>\n</section>\n<section id=\"blobs\">\n<h2>Blobs<a class=\"headerlink\" href=\"#blobs\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>The Runhouse Blob API represents an entity for storing arbitrary data.\nBlobs are associated with a system (local, remote, or file storage), and\ncan be written down or synced to systems.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>import json\nimport pickle\n\nblob_data = list(range(50))\n</pre></div>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span># create and save local blob\nlocal_blob = rh.blob(\n        name=&quot;local_blob&quot;,\n        data=blob_data,\n        system=&quot;file&quot;,\n        path=&quot;local_blob.pickle&quot;\n    ).save()\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">08</span><span class=\"o\">-</span><span class=\"mi\">29</span> <span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">57</span><span class=\"p\">:</span><span class=\"mf\">10.570715</span> <span class=\"o\">|</span> <span class=\"n\">Creating</span> <span class=\"n\">new</span> <span class=\"n\">file</span> <span class=\"n\">folder</span> <span class=\"k\">if</span> <span class=\"n\">it</span> <span class=\"n\">does</span> <span class=\"ow\">not</span> <span class=\"n\">already</span> <span class=\"n\">exist</span> <span class=\"ow\">in</span> <span class=\"n\">path</span><span class=\"p\">:</span> <span class=\"o\">/</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">caroline</span><span class=\"o\">/</span><span class=\"n\">Documents</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"n\">runhouse</span>\n</pre></div>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span># to sync the blob to remote or fs\nlocal_blob.to(system=cluster)\nlocal_blob.to(system=&quot;s3&quot;)\n</pre></div>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span># create blob on s3\nrh.blob(\n    data=blob_data,\n    system=&quot;s3&quot;,\n    path=f&quot;/runhouse-blob/sample_blob.pickle&quot;,\n)\n\n# create blob on cluster\nrh.blob(\n    data=blob_data,\n    system=cluster,\n)\n</pre></div>\n</div>\n<p>To get the contents from a blob, use <code class=\"docutils literal notranslate\"><span class=\"pre\">.fetch()</span></code>:</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>print(local_blob.fetch())\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"s1\">&#39;[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]&#39;</span>\n</pre></div>\n</div>\n<p>Now that you understand the basics, feel free to play around with more\ncomplicated scenarios! You can also check out our additional API and\nexample usage tutorials on our <a class=\"reference external\" href=\"https://www.run.house/docs\">docs\nsite</a>.</p>\n</section>\n<section id=\"cluster-termination\">\n<h2>Cluster Termination<a class=\"headerlink\" href=\"#cluster-termination\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!sky down cpu-cluster\n# or\ncluster.teardown()\n</pre></div>\n</div>\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #008000; text-decoration-color: #008000\">\u2839</span> <span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">Terminating </span><span style=\"color: #008000; text-decoration-color: #008000; font-weight: bold\">cpu-cluster</span>\n</pre></section>\n</section>\n\n    <script type=\"text/x-thebe-config\">\n    {\n        requestKernel: true,\n        binderOptions: {\n            repo: \"binder-examples/jupyter-stacks-datascience\",\n            ref: \"master\",\n        },\n        codeMirrorConfig: {\n            theme: \"abcdef\",\n            mode: \"python\"\n        },\n        kernelOptions: {\n            name: \"python3\",\n            path: \"./tutorials\"\n        },\n        predefinedOutput: true\n    }\n    </script>\n    <script>kernelName = 'python3'</script>", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"]], "sourcename": "tutorials/api_data.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Data: Folders, Tables, &amp; Blobs</a><ul>\n<li><a class=\"reference internal\" href=\"#install-runhouse-and-setup-cluster\">Install Runhouse and Setup Cluster</a></li>\n<li><a class=\"reference internal\" href=\"#folders\">Folders</a></li>\n<li><a class=\"reference internal\" href=\"#tables\">Tables</a></li>\n<li><a class=\"reference internal\" href=\"#blobs\">Blobs</a></li>\n<li><a class=\"reference internal\" href=\"#cluster-termination\">Cluster Termination</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "globaltoc": "<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Getting Started</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick_start_cloud/\">Cloud Quick Start</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick_start_local/\">Local Quick Start</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick_start_den/\">Den Quick Start</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">API Basics</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api_clusters/\">Clusters</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api_modules/\">Functions and Modules</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api_envs/\">Envs and Packages</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api_secrets/\">Secrets</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api_resources/\">Resource Management</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Extra Topics</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"architecture/\">Architecture Overview</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"debugging_logging/\">Debugging and Logging</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"troubleshooting/\">Manual Setup and Troubleshooting</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"security_and_authentication/\">Security and Authentication</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">API Reference</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/python/\">Python API</a><ul>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/resource/\">Resource</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/function/\">Function</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/cluster/\">Cluster</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/env/\">Env</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/package/\">Package</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/module/\">Module</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/mapper/\">Mapper</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/folder/\">Folder</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/table/\">Table</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/blob/\">Blob</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/file/\">File</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/secrets/\">Secrets</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/login/\">Login/Logout</a></li>\n</ul>\n</li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/cli/\">Command Line Interface</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Examples</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"examples/inference/\">Inference: Stable Diffusion and FLAN-T5</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"examples/training/\">Training: Transformers</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"examples/distributed/\">Distributed: HF Accelerate</a></li>\n</ul>\n", "current_page_name": "tutorials/api_data", "sidebars": ["about.html", "navigation.html", "relations.html", "searchbox.html", "donate.html"], "customsidebar": null, "alabaster_version": "0.7.16", "alabaster_version_info": [0, 7, 16]}