{"parents": [], "prev": {"link": "../inference/", "title": "Inference with Runhouse: Stable Diffusion and FLAN-T5"}, "next": {"link": "../distributed/", "title": "Distributed: HuggingFace Accelerate"}, "title": "Training with Runhouse: Dreambooth", "meta": {}, "body": "<section id=\"training-with-runhouse-dreambooth\">\n<h1>Training with Runhouse: Dreambooth<a class=\"headerlink\" href=\"#training-with-runhouse-dreambooth\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p><a href=\"https://colab.research.google.com/github/run-house/tutorials/blob/stable/t02_Dreambooth/x01_colab_dreambooth.ipynb\">\n<img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a></p><p>This tutorial shows how you can easily import and reuse GitHub code\nusing Runhouse. In just a few lines of code, we can fine-tune Stable\nDiffusion using Dreambooth and perform inference.</p>\n<p>Note that this code runs on <strong>your own GPU</strong>. You can run this on your\nown cluster, or through a standard cloud account (AWS, GCP, Azure,\nLambdaLabs). If you do not have any compute or cloud accounts set up, we\nrecommend creating a <a class=\"reference external\" href=\"https://cloud.lambdalabs.com/\">LambdaLabs</a>\naccount for the easiest setup path.</p>\n<section id=\"install-runhouse\">\n<h2>Install Runhouse<a class=\"headerlink\" href=\"#install-runhouse\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span>!pip install runhouse\n</pre></div>\n</div>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">runhouse</span> <span class=\"k\">as</span> <span class=\"nn\">rh</span>\n</pre></div>\n</div>\n<section id=\"optional-log-in-to-runhouse-to-load-in-secrets\">\n<h3>[Optional] Log in to Runhouse to load in secrets<a class=\"headerlink\" href=\"#optional-log-in-to-runhouse-to-load-in-secrets\" title=\"Permalink to this heading\">\u00b6</a></h3>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># You can add token=&lt;your token&gt; if you want to be able to run this without pasting into stdin</span>\n<span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">login</span><span class=\"p\">(</span><span class=\"n\">download_secrets</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">download_config</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">interactive</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span># Only if you&#39;re using GCP and running inside Colab!\n!gcloud init\n!gcloud auth application-default login\n!cp -r /content/.config/* ~/.config/gcloud\n</pre></div>\n</div>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span># Check that secrets are loaded in properly and at least one cloud is ready to use.\n!sky check\n</pre></div>\n</div>\n</section>\n</section>\n<section id=\"dreambooth-fine-tuning-and-inference\">\n<h2>Dreambooth Fine-Tuning and Inference<a class=\"headerlink\" href=\"#dreambooth-fine-tuning-and-inference\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>Please refer to <a class=\"reference external\" href=\"https://runhouse-docs.readthedocs-hosted.com/en/stable/installation.html#cluster-setup\">cluster\nsetup</a>\nfor instructions on setting up local hardware credentials, if you\nhaven\u2019t done so yet.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">gpu</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">cluster</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">&#39;rh-a10x&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">gpu</span><span class=\"o\">.</span><span class=\"n\">up_if_not</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>Upload training photos to Colab, place them in a folder, and send our\nlocal folder to the cluster.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">google.colab</span> <span class=\"kn\">import</span> <span class=\"n\">files</span>\n<span class=\"kn\">import</span> <span class=\"nn\">shutil</span>\n<span class=\"kn\">from</span> <span class=\"nn\">pathlib</span> <span class=\"kn\">import</span> <span class=\"n\">Path</span>\n\n<span class=\"n\">uploaded</span> <span class=\"o\">=</span> <span class=\"n\">files</span><span class=\"o\">.</span><span class=\"n\">upload</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">input_images_dir</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;instance_images&#39;</span>\n<span class=\"n\">images_path</span> <span class=\"o\">=</span> <span class=\"n\">Path</span><span class=\"p\">(</span><span class=\"n\">input_images_dir</span><span class=\"p\">)</span>\n<span class=\"n\">images_path</span><span class=\"o\">.</span><span class=\"n\">mkdir</span><span class=\"p\">(</span><span class=\"n\">exist_ok</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">filename</span> <span class=\"ow\">in</span> <span class=\"n\">uploaded</span><span class=\"o\">.</span><span class=\"n\">keys</span><span class=\"p\">():</span>\n  <span class=\"n\">shutil</span><span class=\"o\">.</span><span class=\"n\">move</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">,</span> <span class=\"n\">images_path</span> <span class=\"o\">/</span> <span class=\"n\">filename</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">remote_image_dir</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;dreambooth/instance_images&#39;</span>\n<span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">folder</span><span class=\"p\">(</span><span class=\"n\">path</span><span class=\"o\">=</span><span class=\"n\">input_images_dir</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">system</span><span class=\"o\">=</span><span class=\"n\">gpu</span><span class=\"p\">,</span> <span class=\"n\">path</span><span class=\"o\">=</span><span class=\"n\">remote_image_dir</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">28</span><span class=\"p\">:</span><span class=\"mi\">33</span><span class=\"p\">,</span><span class=\"mi\">040</span> <span class=\"o\">|</span> <span class=\"n\">Copying</span> <span class=\"n\">folder</span> <span class=\"kn\">from</span> <span class=\"nn\">file</span><span class=\"p\">:</span><span class=\"o\">///</span><span class=\"n\">content</span><span class=\"o\">/</span><span class=\"n\">instance_images</span> <span class=\"n\">to</span><span class=\"p\">:</span> <span class=\"n\">rh</span><span class=\"o\">-</span><span class=\"n\">a10x</span><span class=\"o\">-</span><span class=\"n\">aws</span><span class=\"p\">,</span> <span class=\"k\">with</span> <span class=\"n\">url</span><span class=\"p\">:</span> <span class=\"n\">dreambooth</span><span class=\"o\">/</span><span class=\"n\">instance_images</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">28</span><span class=\"p\">:</span><span class=\"mi\">33</span><span class=\"p\">,</span><span class=\"mi\">045</span> <span class=\"o\">|</span> <span class=\"n\">Creating</span> <span class=\"n\">new</span> <span class=\"n\">ssh</span> <span class=\"n\">folder</span><span class=\"p\">:</span> <span class=\"n\">dreambooth</span><span class=\"o\">/</span><span class=\"n\">instance_images</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">28</span><span class=\"p\">:</span><span class=\"mi\">33</span><span class=\"p\">,</span><span class=\"mi\">160</span> <span class=\"o\">|</span> <span class=\"n\">Opening</span> <span class=\"n\">SSH</span> <span class=\"n\">connection</span> <span class=\"n\">to</span> <span class=\"mf\">3.84.165.104</span><span class=\"p\">,</span> <span class=\"n\">port</span> <span class=\"mi\">22</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">28</span><span class=\"p\">:</span><span class=\"mi\">33</span><span class=\"p\">,</span><span class=\"mi\">183</span> <span class=\"o\">|</span> <span class=\"p\">[</span><span class=\"n\">conn</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">Connected</span> <span class=\"n\">to</span> <span class=\"n\">SSH</span> <span class=\"n\">server</span> <span class=\"n\">at</span> <span class=\"mf\">3.84.165.104</span><span class=\"p\">,</span> <span class=\"n\">port</span> <span class=\"mi\">22</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">28</span><span class=\"p\">:</span><span class=\"mi\">33</span><span class=\"p\">,</span><span class=\"mi\">184</span> <span class=\"o\">|</span> <span class=\"p\">[</span><span class=\"n\">conn</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">]</span>   <span class=\"n\">Local</span> <span class=\"n\">address</span><span class=\"p\">:</span> <span class=\"mf\">172.28.0.12</span><span class=\"p\">,</span> <span class=\"n\">port</span> <span class=\"mi\">34054</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">28</span><span class=\"p\">:</span><span class=\"mi\">33</span><span class=\"p\">,</span><span class=\"mi\">187</span> <span class=\"o\">|</span> <span class=\"p\">[</span><span class=\"n\">conn</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">]</span>   <span class=\"n\">Peer</span> <span class=\"n\">address</span><span class=\"p\">:</span> <span class=\"mf\">3.84.165.104</span><span class=\"p\">,</span> <span class=\"n\">port</span> <span class=\"mi\">22</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">28</span><span class=\"p\">:</span><span class=\"mi\">33</span><span class=\"p\">,</span><span class=\"mi\">280</span> <span class=\"o\">|</span> <span class=\"p\">[</span><span class=\"n\">conn</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">Beginning</span> <span class=\"n\">auth</span> <span class=\"k\">for</span> <span class=\"n\">user</span> <span class=\"n\">ubuntu</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">28</span><span class=\"p\">:</span><span class=\"mi\">33</span><span class=\"p\">,</span><span class=\"mi\">367</span> <span class=\"o\">|</span> <span class=\"p\">[</span><span class=\"n\">conn</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">Auth</span> <span class=\"k\">for</span> <span class=\"n\">user</span> <span class=\"n\">ubuntu</span> <span class=\"n\">succeeded</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">28</span><span class=\"p\">:</span><span class=\"mi\">33</span><span class=\"p\">,</span><span class=\"mi\">371</span> <span class=\"o\">|</span> <span class=\"p\">[</span><span class=\"n\">conn</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">chan</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">Requesting</span> <span class=\"n\">new</span> <span class=\"n\">SSH</span> <span class=\"n\">session</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">28</span><span class=\"p\">:</span><span class=\"mi\">33</span><span class=\"p\">,</span><span class=\"mi\">720</span> <span class=\"o\">|</span> <span class=\"p\">[</span><span class=\"n\">conn</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">chan</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">]</span>   <span class=\"n\">Subsystem</span><span class=\"p\">:</span> <span class=\"n\">sftp</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">28</span><span class=\"p\">:</span><span class=\"mi\">33</span><span class=\"p\">,</span><span class=\"mi\">743</span> <span class=\"o\">|</span> <span class=\"p\">[</span><span class=\"n\">conn</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">chan</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"n\">Starting</span> <span class=\"n\">SFTP</span> <span class=\"n\">client</span>\n</pre></div>\n</div>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"o\">&lt;</span><span class=\"n\">runhouse</span><span class=\"o\">.</span><span class=\"n\">rns</span><span class=\"o\">.</span><span class=\"n\">folders</span><span class=\"o\">.</span><span class=\"n\">folder</span><span class=\"o\">.</span><span class=\"n\">Folder</span> <span class=\"n\">at</span> <span class=\"mh\">0x7f4341c64c10</span><span class=\"o\">&gt;</span>\n</pre></div>\n</div>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># Install packages necessary for dreambooth training</span>\n<span class=\"n\">gpu</span><span class=\"o\">.</span><span class=\"n\">install_packages</span><span class=\"p\">([</span><span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">GitPackage</span><span class=\"p\">(</span><span class=\"n\">git_url</span><span class=\"o\">=</span><span class=\"s1\">&#39;https://github.com/huggingface/diffusers.git&#39;</span><span class=\"p\">,</span>\n                                    <span class=\"n\">install_method</span><span class=\"o\">=</span><span class=\"s1\">&#39;pip&#39;</span><span class=\"p\">,</span> <span class=\"n\">revision</span><span class=\"o\">=</span><span class=\"s1\">&#39;v0.11.1&#39;</span><span class=\"p\">),</span>\n                      <span class=\"s1\">&#39;datasets&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;accelerate&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;transformers&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;bitsandbytes&#39;</span><span class=\"p\">,</span>\n                      <span class=\"s1\">&#39;torch --upgrade --extra-index-url https://download.pytorch.org/whl/cu117&#39;</span><span class=\"p\">,</span>\n                      <span class=\"s1\">&#39;torchvision --upgrade --extra-index-url https://download.pytorch.org/whl/cu117&#39;</span><span class=\"p\">])</span>\n</pre></div>\n</div>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span>INFO | 2023-02-07 17:28:59,773 | Connected (version 2.0, client OpenSSH_8.2p1)\nINFO | 2023-02-07 17:28:59,987 | Authentication (publickey) successful!\nINFO | 2023-02-07 17:29:00,266 | Installing packages on cluster rh-a10x-aws: [&#39;GitPackage: https://github.com/huggingface/diffusers.git@v0.11.1&#39;, &#39;datasets&#39;, &#39;accelerate&#39;, &#39;transformers&#39;, &#39;bitsandbytes&#39;, &#39;torch --upgrade --extra-index-url https://download.pytorch.org/whl/cu117&#39;, &#39;torchvision --upgrade --extra-index-url https://download.pytorch.org/whl/cu117&#39;]\n</pre></div>\n</div>\n<p>Launch dreambooth training from <a class=\"reference external\" href=\"https://github.com/huggingface/diffusers/tree/main/examples/dreambooth\">Hugging Face\nexample</a>,\njust as you would from command line!</p>\n<p>Note that this training job takes ~20 minutes to run.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">class_name</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;dog&quot;</span>\n\n<span class=\"n\">gpu</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">([</span><span class=\"sa\">f</span><span class=\"s1\">&#39;accelerate launch diffusers/examples/dreambooth/train_dreambooth.py &#39;</span>\n         <span class=\"sa\">f</span><span class=\"s1\">&#39;--pretrained_model_name_or_path=stabilityai/stable-diffusion-2-base &#39;</span>\n         <span class=\"sa\">f</span><span class=\"s1\">&#39;--instance_data_dir=dreambooth/instance_images &#39;</span>\n         <span class=\"sa\">f</span><span class=\"s1\">&#39;--class_data_dir=dreambooth/class_images &#39;</span>\n         <span class=\"sa\">f</span><span class=\"s1\">&#39;--output_dir=dreambooth/output &#39;</span>\n         <span class=\"sa\">f</span><span class=\"s1\">&#39;--with_prior_preservation --prior_loss_weight=1.0 &#39;</span>\n         <span class=\"sa\">f</span><span class=\"s1\">&#39;--instance_prompt=&quot;a photo of sks </span><span class=\"si\">{</span><span class=\"n\">class_name</span><span class=\"si\">}</span><span class=\"s1\">&quot; &#39;</span>\n         <span class=\"sa\">f</span><span class=\"s1\">&#39;--class_prompt=&quot;a photo of </span><span class=\"si\">{</span><span class=\"n\">class_name</span><span class=\"si\">}</span><span class=\"s1\">&quot; &#39;</span>\n         <span class=\"sa\">f</span><span class=\"s1\">&#39;--resolution=512 --max_train_steps=800 &#39;</span>\n         <span class=\"sa\">f</span><span class=\"s1\">&#39;--train_batch_size=1 --gradient_accumulation_steps=2 --gradient_checkpointing --use_8bit_adam &#39;</span>\n         <span class=\"sa\">f</span><span class=\"s1\">&#39;--learning_rate=5e-6 --lr_scheduler=&quot;constant&quot; --lr_warmup_steps=0 --num_class_images=200 &#39;</span>\n         <span class=\"sa\">f</span><span class=\"s1\">&#39;--mixed_precision=bf16 &#39;</span>\n         <span class=\"c1\"># f&#39;--train_text_encoder &#39;  # Uncomment if training on A100, but too heavy for A10G (AWS)</span>\n<span class=\"p\">])</span>\n</pre></div>\n</div>\n<p>Reuse our <code class=\"docutils literal notranslate\"><span class=\"pre\">sd_generate_pinned</span></code> Stable Diffusion model from Tutorial 1\nto generate images of our prompt, fine-tuned on our images.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">model_path</span> <span class=\"o\">=</span> <span class=\"s1\">&#39;dreambooth/output&#39;</span>\n<span class=\"n\">my_prompt</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;sks dog in a field of purple flowers&quot;</span>\n\n<span class=\"n\">generate_dreambooth</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">function</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">&#39;sd_generate_pinned&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">images</span> <span class=\"o\">=</span> <span class=\"n\">generate_dreambooth</span><span class=\"p\">(</span><span class=\"n\">my_prompt</span><span class=\"p\">,</span>\n                             <span class=\"n\">model_id</span><span class=\"o\">=</span><span class=\"n\">model_path</span><span class=\"p\">,</span>\n                             <span class=\"n\">num_images</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">guidance_scale</span><span class=\"o\">=</span><span class=\"mf\">7.5</span><span class=\"p\">,</span>\n                             <span class=\"n\">steps</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">)</span>\n\n<span class=\"p\">[</span><span class=\"n\">display</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">image</span> <span class=\"ow\">in</span> <span class=\"n\">images</span><span class=\"p\">]</span>\n</pre></div>\n</div>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">54</span><span class=\"p\">:</span><span class=\"mi\">24</span><span class=\"p\">,</span><span class=\"mi\">482</span> <span class=\"o\">|</span> <span class=\"n\">Running</span> <span class=\"n\">sd_generate_pinned</span> <span class=\"n\">via</span> <span class=\"n\">gRPC</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">07</span> <span class=\"mi\">17</span><span class=\"p\">:</span><span class=\"mi\">54</span><span class=\"p\">:</span><span class=\"mi\">59</span><span class=\"p\">,</span><span class=\"mi\">033</span> <span class=\"o\">|</span> <span class=\"n\">Time</span> <span class=\"n\">to</span> <span class=\"n\">send</span> <span class=\"n\">message</span><span class=\"p\">:</span> <span class=\"mf\">34.55</span> <span class=\"n\">seconds</span>\n</pre></div>\n</div>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"p\">[</span><span class=\"n\">display</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">image</span> <span class=\"ow\">in</span> <span class=\"n\">images</span><span class=\"p\">]</span>\n</pre></div>\n</div>\n<img alt=\"tutorials/examples/x01_colab_dreambooth_files/x01_colab_dreambooth_20_0.png\" src=\"tutorials/examples/x01_colab_dreambooth_files/x01_colab_dreambooth_20_0.png\" />\n<img alt=\"tutorials/examples/x01_colab_dreambooth_files/x01_colab_dreambooth_20_1.png\" src=\"tutorials/examples/x01_colab_dreambooth_files/x01_colab_dreambooth_20_1.png\" />\n<img alt=\"tutorials/examples/x01_colab_dreambooth_files/x01_colab_dreambooth_20_2.png\" src=\"tutorials/examples/x01_colab_dreambooth_files/x01_colab_dreambooth_20_2.png\" />\n<img alt=\"tutorials/examples/x01_colab_dreambooth_files/x01_colab_dreambooth_20_3.png\" src=\"tutorials/examples/x01_colab_dreambooth_files/x01_colab_dreambooth_20_3.png\" />\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"p\">[</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"kc\">None</span><span class=\"p\">]</span>\n</pre></div>\n</div>\n</section>\n</section>\n\n    <script type=\"text/x-thebe-config\">\n    {\n        requestKernel: true,\n        binderOptions: {\n            repo: \"binder-examples/jupyter-stacks-datascience\",\n            ref: \"master\",\n        },\n        codeMirrorConfig: {\n            theme: \"abcdef\",\n            mode: \"python\"\n        },\n        kernelOptions: {\n            kernelName: \"python3\",\n            path: \"./tutorials/examples\"\n        },\n        predefinedOutput: true\n    }\n    </script>\n    <script>kernelName = 'python3'</script>", "metatags": "<meta name=\"generator\" content=\"Docutils 0.18.1: http://docutils.sourceforge.net/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["tutorials/examples/distributed", "Distributed: HuggingFace Accelerate", "N", "next"], ["tutorials/examples/inference", "Inference with Runhouse: Stable Diffusion and FLAN-T5", "P", "previous"]], "sourcename": "tutorials/examples/training.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Training with Runhouse: Dreambooth</a><ul>\n<li><a class=\"reference internal\" href=\"#install-runhouse\">Install Runhouse</a><ul>\n<li><a class=\"reference internal\" href=\"#optional-log-in-to-runhouse-to-load-in-secrets\">[Optional] Log in to Runhouse to load in secrets</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#dreambooth-fine-tuning-and-inference\">Dreambooth Fine-Tuning and Inference</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "tutorials/examples/training", "sidebars": ["sidebar-logo.html", "search-field.html", "sbt-sidebar-nav.html", "sbt-sidebar-footer.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.12", "pagetitle": "Training with Runhouse: Dreambooth", "page_description": "Training with Runhouse: Dreambooth  <p><a href=\"https://colab.research.google.com/github/run-house/tutorials/blob/stable/t02_Dreambooth/x01_colab_dreambooth.ipy", "author": "the Runhouse team \ud83c\udfc3\u200d\u2640\ufe0f\ud83c\udfe0", "github_user": "run-house", "github_repo": "runhouse", "github_version": "stable", "doc_path": "docs/", "theme_search_bar_text": "Search the docs ...", "theme_show_toc_level": 1}