{"parents": [], "prev": {"link": "../../", "title": "\ud83c\udfc3\u200d\u2640\ufe0f Runhouse Docs \ud83c\udfe0"}, "next": {"link": "../quick-start-local/", "title": "Local Quick Start"}, "title": "Cloud Quick Start", "meta": {}, "body": "<section id=\"cloud-quick-start\">\n<h1>Cloud Quick Start<a class=\"headerlink\" href=\"#cloud-quick-start\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p><a href=\"https://colab.research.google.com/github/run-house/notebooks/blob/stable/docs/quick-start-cloud.ipynb\">\n<img height=\"20px\" width=\"117px\" src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a></p><p>Runhouse lets you quickly and easily deploy your Python code to any remote infra, as if it were attached to your laptop.</p>\n<p>This tutorial demonstrates how to</p>\n<ul class=\"simple\">\n<li><p>Connect to an existing remote IP, fresh cloud VM, or Kubernetes pod in Python.</p></li>\n<li><p>Send a locally defined function onto the remote compute and call it as a service.</p></li>\n</ul>\n<section id=\"installing-runhouse\">\n<h2>Installing Runhouse<a class=\"headerlink\" href=\"#installing-runhouse\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>The Runhouse base package can be installed with:</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!pip install runhouse\n</pre></div>\n</div>\n<p>To use Runhouse to launch on-demand clusters, please instead run the\nfollowing command. This additionally installs\n<a class=\"reference external\" href=\"https://github.com/skypilot-org/skypilot\">SkyPilot</a>, which is used\nfor launching fresh VMs through your cloud provider.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!pip install &quot;runhouse[sky]&quot;\n</pre></div>\n</div>\n</section>\n<section id=\"local-python-function\">\n<h2>Local Python Function<a class=\"headerlink\" href=\"#local-python-function\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>First, let\u2019s define the function that we want to be run on our remote\ncompute. This is just a regular Python function; no decorators,\nwrappers, or configs are necessary.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>def get_pid(a = 0):\n    import os\n    return os.getpid()\n</pre></div>\n</div>\n</section>\n<section id=\"runhouse-cluster\">\n<h2>Runhouse Cluster<a class=\"headerlink\" href=\"#runhouse-cluster\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>In Runhouse, a \u201ccluster\u201d is a unit of compute, somewhere you can send\ncode, data, or requests to execute. We define a Runhouse cluster using\nthe <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.cluster</span></code> factory function.</p>\n<p>This requires having access to existing compute via SSH, a cloud provider account, or a Kubernetes cluster\n(.kube/config). If you do not have access to a cluster, you can try the <a class=\"reference external\" href=\"https://www.run.house/docs/tutorials/quick-start-local\">local\nversion</a> of this\ntutorial, which sets up and deploys the Python function to a local\nserver, rather than a remote cluster.</p>\n<p>To use a cluster that\u2019s already running:</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster = rh.cluster(\n    name=&quot;rh-cluster&quot;,\n    host=&quot;example-cluster&quot;,  # hostname or ip address,\n    ssh_creds={&quot;ssh_user&quot;: &quot;ubuntu&quot;, &quot;ssh_private_key&quot;: &quot;~/.ssh/id_rsa&quot;},  # credentials for ssh-ing into the cluster\n)\n</pre></div>\n</div>\n<p>If you do not have a cluster up, but have cloud credentials (e.g.\u00a0aws,\ngcp, azure) for launching clusters or a Kubernetes cluster, you can set\nup and launch an on-demand cluster with <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.ondemand_cluster</span></code>. This uses SkyPilot under\nthe hood, so run <code class=\"docutils literal notranslate\"><span class=\"pre\">sky</span> <span class=\"pre\">check</span></code> in a CLI first to make sure credentials are set up properly.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster = rh.ondemand_cluster(\n    name=&quot;rh-cluster&quot;,\n    instance_type=&quot;CPU:2+&quot;,\n    provider=&quot;aws&quot;\n)\ncluster.up_if_not()\n\n# terminate this cluster with `cluster.teardown()` in Python, or `sky down rh-cluster` in CLI\n</pre></div>\n</div>\n<p>There are a number of options to specify the resources more finely, such as GPUs (<code class=\"docutils literal notranslate\"><span class=\"pre\">instance_type=&quot;A10G:4&quot;</span></code>),\ncloud provider names (<code class=\"docutils literal notranslate\"><span class=\"pre\">instance_type=&quot;m5.xlarge&quot;</span></code>), <code class=\"docutils literal notranslate\"><span class=\"pre\">num_instances=n</span></code> for multiple instances,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">memory</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">disk_size</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">region</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">image_id</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">open_ports</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">spot</span></code>, and more. See the\n<a class=\"reference external\" href=\"https://www.run.house/docs/api/python/cluster#runhouse.ondemand_cluster\">on_demand_cluster docs</a>.\nYou can also omit the provider argument to allocate from the cheapest available source for which you\nhave credentials.</p>\n</section>\n<section id=\"deployment\">\n<h2>Deployment<a class=\"headerlink\" href=\"#deployment\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>Simply wrap the function in <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.function</span></code> and send it to the\ncluster with <code class=\"docutils literal notranslate\"><span class=\"pre\">.to</span></code>. This actually deploys the function to the cluster as a\nproper service by syncing over the code, setting up any specified\ndependencies (see <code class=\"docutils literal notranslate\"><span class=\"pre\">Envs</span></code>), and importing and serving it in the Runhouse API server.\nWe\u2019re connected via an SSH tunnel here, so the service is secure, but we can also open ports\nand secure it with Runhouse\u2019s out-of-the-box authentication and HTTPS.</p>\n<p>Classes, or <code class=\"docutils literal notranslate\"><span class=\"pre\">Modules</span></code> are also supported, opening up a world of possibilities\nthrough persistent state. <code class=\"docutils literal notranslate\"><span class=\"pre\">Envs</span></code> allow you to specify the environment in which the\nfunction or class is served, such as dependencies, environment variables, secrets,\nconda environments, and more, and allow you to easily achieve powerful parallelism across the cluster.\nThese are covered in more detail in the API tutorials.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>remote_fn = rh.function(get_pid).to(cluster)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">26</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">01</span><span class=\"p\">:</span><span class=\"mf\">50.579156</span> <span class=\"o\">|</span> <span class=\"n\">Because</span> <span class=\"n\">this</span> <span class=\"n\">function</span> <span class=\"ow\">is</span> <span class=\"n\">defined</span> <span class=\"ow\">in</span> <span class=\"n\">a</span> <span class=\"n\">notebook</span><span class=\"p\">,</span> <span class=\"n\">writing</span> <span class=\"n\">it</span> <span class=\"n\">out</span> <span class=\"n\">to</span> <span class=\"n\">a</span> <span class=\"n\">file</span> <span class=\"n\">to</span> <span class=\"n\">make</span> <span class=\"n\">it</span> <span class=\"n\">importable</span><span class=\"o\">.</span> <span class=\"n\">Please</span> <span class=\"n\">make</span> <span class=\"n\">sure</span> <span class=\"n\">the</span> <span class=\"n\">function</span> <span class=\"n\">does</span> <span class=\"ow\">not</span> <span class=\"n\">rely</span> <span class=\"n\">on</span> <span class=\"nb\">any</span> <span class=\"n\">local</span> <span class=\"n\">variables</span><span class=\"p\">,</span> <span class=\"n\">including</span> <span class=\"n\">imports</span> <span class=\"p\">(</span><span class=\"n\">which</span> <span class=\"n\">should</span> <span class=\"n\">be</span> <span class=\"n\">moved</span> <span class=\"n\">inside</span> <span class=\"n\">the</span> <span class=\"n\">function</span> <span class=\"n\">body</span><span class=\"p\">)</span><span class=\"o\">.</span> <span class=\"n\">Functions</span> <span class=\"n\">defined</span> <span class=\"ow\">in</span> <span class=\"n\">Python</span> <span class=\"n\">files</span> <span class=\"n\">can</span> <span class=\"n\">be</span> <span class=\"n\">used</span> <span class=\"n\">normally</span><span class=\"o\">.</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">26</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">01</span><span class=\"p\">:</span><span class=\"mf\">50.584346</span> <span class=\"o\">|</span> <span class=\"n\">Copying</span> <span class=\"n\">package</span> <span class=\"kn\">from</span> <span class=\"nn\">file</span><span class=\"p\">:</span><span class=\"o\">///</span><span class=\"n\">Users</span><span class=\"o\">/</span><span class=\"n\">caroline</span><span class=\"o\">/</span><span class=\"n\">Documents</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"n\">notebooks</span> <span class=\"n\">to</span><span class=\"p\">:</span> <span class=\"n\">rh</span><span class=\"o\">-</span><span class=\"n\">cluster</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">26</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">01</span><span class=\"p\">:</span><span class=\"mf\">54.745264</span> <span class=\"o\">|</span> <span class=\"n\">Calling</span> <span class=\"n\">base_env</span><span class=\"o\">.</span><span class=\"n\">install</span>\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span>\u001b[36mInstalling Package: notebooks with method reqs.\n\u001b[0m\u001b[36mreqs path: notebooks/requirements.txt\n\u001b[0m\u001b[36mnotebooks/requirements.txt not found, skipping\n\u001b[0m\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">26</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">01</span><span class=\"p\">:</span><span class=\"mf\">56.116714</span> <span class=\"o\">|</span> <span class=\"n\">Time</span> <span class=\"n\">to</span> <span class=\"n\">call</span> <span class=\"n\">base_env</span><span class=\"o\">.</span><span class=\"n\">install</span><span class=\"p\">:</span> <span class=\"mf\">1.37</span> <span class=\"n\">seconds</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">26</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">02</span><span class=\"p\">:</span><span class=\"mf\">04.892297</span> <span class=\"o\">|</span> <span class=\"n\">Sending</span> <span class=\"n\">module</span> <span class=\"n\">get_pid</span> <span class=\"n\">to</span> <span class=\"n\">rh</span><span class=\"o\">-</span><span class=\"n\">cluster</span>\n</pre></div>\n</div>\n<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">\n</pre><p>The function we defined above, <code class=\"docutils literal notranslate\"><span class=\"pre\">get_pid</span></code>, now exists remotely on the\ncluster, and can be called remotely using <code class=\"docutils literal notranslate\"><span class=\"pre\">remote_fn</span></code>. You can call\nthis remote function just as you would any other Python function, with\n<code class=\"docutils literal notranslate\"><span class=\"pre\">remote_fn()</span></code>, and it runs on the cluster and returns the result to\nour local environment.</p>\n<p>Below, we run both the local and remote versions of this function, which\ngive different results and confirms that the functions are indeed being\nrun on different processes.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>print(f&quot;Local PID {get_pid()}&quot;)\nprint(f&quot;Remote PID {remote_fn()}&quot;)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">26</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">02</span><span class=\"p\">:</span><span class=\"mf\">43.117612</span> <span class=\"o\">|</span> <span class=\"n\">Calling</span> <span class=\"n\">get_pid</span><span class=\"o\">.</span><span class=\"n\">call</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">26</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">02</span><span class=\"p\">:</span><span class=\"mf\">44.228964</span> <span class=\"o\">|</span> <span class=\"n\">Time</span> <span class=\"n\">to</span> <span class=\"n\">call</span> <span class=\"n\">get_pid</span><span class=\"o\">.</span><span class=\"n\">call</span><span class=\"p\">:</span> <span class=\"mf\">1.11</span> <span class=\"n\">seconds</span>\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">Local</span> <span class=\"n\">PID</span> <span class=\"mi\">27818</span>\n<span class=\"n\">Remote</span> <span class=\"n\">PID</span> <span class=\"mi\">33366</span>\n</pre></div>\n</div>\n<p>If you launched an on-demand cluster, you can terminate it by calling\n<code class=\"docutils literal notranslate\"><span class=\"pre\">cluster.teardown()</span></code>.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster.teardown()\n</pre></div>\n</div>\n</section>\n<section id=\"dive-deeper\">\n<h2>Dive Deeper<a class=\"headerlink\" href=\"#dive-deeper\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>What we just did, running a locally defined function on remote compute,\nis just the tip of the iceberg of what\u2019s possible with Runhouse. With a\nlarge suite of even more abstractions and features, Runhouse lets you\nquickly and seamlessly integrate between local and remote environments.</p>\n<p>To learn more, please take a look at our other tutorials, or at the <a class=\"reference external\" href=\"https://www.run.house/docs/api/python\">API\nreference</a></p>\n</section>\n</section>\n\n    <script type=\"text/x-thebe-config\">\n    {\n        requestKernel: true,\n        binderOptions: {\n            repo: \"binder-examples/jupyter-stacks-datascience\",\n            ref: \"master\",\n        },\n        codeMirrorConfig: {\n            theme: \"abcdef\",\n            mode: \"python\"\n        },\n        kernelOptions: {\n            name: \"python3\",\n            path: \"./tutorials\"\n        },\n        predefinedOutput: true\n    }\n    </script>\n    <script>kernelName = 'python3'</script>", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["tutorials/quick-start-local", "Local Quick Start", "N", "next"], ["index", "\ud83c\udfc3\u200d\u2640\ufe0f Runhouse Docs \ud83c\udfe0", "P", "previous"]], "sourcename": "tutorials/quick-start-cloud.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Cloud Quick Start</a><ul>\n<li><a class=\"reference internal\" href=\"#installing-runhouse\">Installing Runhouse</a></li>\n<li><a class=\"reference internal\" href=\"#local-python-function\">Local Python Function</a></li>\n<li><a class=\"reference internal\" href=\"#runhouse-cluster\">Runhouse Cluster</a></li>\n<li><a class=\"reference internal\" href=\"#deployment\">Deployment</a></li>\n<li><a class=\"reference internal\" href=\"#dive-deeper\">Dive Deeper</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "globaltoc": "<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Getting Started</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick-start-cloud/\">Cloud Quick Start</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick-start-local/\">Local Quick Start</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick-start-den/\">Den Quick Start</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">API Basics</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-clusters/\">Clusters</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-modules/\">Functions and Modules</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-envs/\">Envs and Packages</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-folders/\">Folders</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-secrets/\">Secrets</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-resources/\">Resource Management</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">API Reference</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/python/\">Python API</a><ul>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/resource/\">Resource</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/function/\">Function</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/cluster/\">Cluster</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/env/\">Env</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/package/\">Package</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/module/\">Module</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/mapper/\">Mapper</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/folder/\">Folder</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/table/\">Table</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/blob/\">Blob</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/file/\">File</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/secrets/\">Secrets</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/login/\">Login/Logout</a></li>\n</ul>\n</li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/cli/\">Command Line Interface</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Other Topics</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/async/\">Asynchronous Programming</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"architecture/\">Architecture Overview</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"debugging-logging/\">Debugging and Logging</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"troubleshooting/\">Manual Setup and Troubleshooting</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"security-and-authentication/\">Security and Authentication</a></li>\n</ul>\n", "current_page_name": "tutorials/quick-start-cloud", "sidebars": ["about.html", "navigation.html", "relations.html", "searchbox.html", "donate.html"], "customsidebar": null, "alabaster_version": "0.7.16", "alabaster_version_info": [0, 7, 16]}