{"parents": [], "prev": {"link": "../../", "title": "\ud83c\udfc3\u200d\u2640\ufe0f Runhouse Docs \ud83c\udfe0"}, "next": {"link": "../quick-start-local/", "title": "Local Quick Start"}, "title": "Cloud Quick Start", "meta": {}, "body": "<section id=\"cloud-quick-start\">\n<h1>Cloud Quick Start<a class=\"headerlink\" href=\"#cloud-quick-start\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p><a href=\"https://colab.research.google.com/github/run-house/notebooks/blob/stable/docs/quick-start-cloud.ipynb\">\n<img height=\"20px\" width=\"117px\" src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a></p><p>Runhouse lets you easily deploy and run Python subroutines on remote\ninfrastructure, granting you access to boundless compute from inside\nyour Python interpreter.</p>\n<p>This tutorial demonstrates how to</p>\n<ul class=\"simple\">\n<li><p>Connect to an existing remote IP, fresh cloud VM, or fresh Kubernetes\npod in Python as a Runhouse cluster</p></li>\n<li><p>Send a locally defined function onto the remote compute and call it\nas a service</p></li>\n</ul>\n<section id=\"installing-runhouse\">\n<h2>Installing Runhouse<a class=\"headerlink\" href=\"#installing-runhouse\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>The Runhouse base package can be installed with:</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!pip install runhouse\n</pre></div>\n</div>\n<p>To use Runhouse to launch on-demand clusters, please instead run the\nfollowing command. This additionally installs\n<a class=\"reference external\" href=\"https://github.com/skypilot-org/skypilot\">SkyPilot</a>, which is used\nfor launching fresh VMs through your cloud provider.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!pip install &quot;runhouse[sky]&quot;\n</pre></div>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>import runhouse as rh\n</pre></div>\n</div>\n</section>\n<section id=\"local-python-function\">\n<h2>Local Python Function<a class=\"headerlink\" href=\"#local-python-function\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>First, let\u2019s define the function that we want to be run on our remote\ncompute. This is just a regular Python function; no decorators,\nwrappers, or configs are necessary.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>def get_platform(a = 0):\n    import platform\n    return platform.platform()\n</pre></div>\n</div>\n</section>\n<section id=\"runhouse-cluster\">\n<h2>Runhouse Cluster<a class=\"headerlink\" href=\"#runhouse-cluster\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>In Runhouse, a \u201ccluster\u201d is a unit of compute, somewhere you can send\ncode, data, or requests to execute. We define a Runhouse cluster using\nthe <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.cluster</span></code> factory function.</p>\n<p>This requires having access to an existing box (via SSH), a cloud\nprovider account, or a Kubernetes cluster (~/.kube/config). If you do\nnot have access to a cluster, you can try the <a class=\"reference external\" href=\"https://www.run.house/docs/tutorials/quick-start-local\">local\nversion</a> of\nthis tutorial, which sets up and deploys the Python function to a local\nserver, rather than a remote cluster.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Make sure that any code in your Python file that\u2019s meant to only run\nlocally is placed within a <code class=\"docutils literal notranslate\"><span class=\"pre\">if</span> <span class=\"pre\">__name__</span> <span class=\"pre\">==</span> <span class=\"pre\">&quot;__main__&quot;:</span></code> block.\nOtherwise, that code will run when Runhouse attempts to import your\ncode remotely. For example, you wouldn\u2019t want\n<code class=\"docutils literal notranslate\"><span class=\"pre\">function.to(cluster)</span></code> to run again on the cluster. This is not\nnecessary when using a notebook. Please see our <a class=\"reference external\" href=\"https://github.com/run-house/runhouse/tree/main/examples\">examples\ndirectory</a>\nfor implementation details.</p>\n</div>\n<p>To use a cluster that\u2019s already running:</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster = rh.cluster(\n    name=&quot;rh-cluster&quot;,\n    host=&quot;example-cluster&quot;,  # hostname or ip address,\n    ssh_creds={&quot;ssh_user&quot;: &quot;ubuntu&quot;, &quot;ssh_private_key&quot;: &quot;~/.ssh/id_rsa&quot;},  # credentials for ssh-ing into the cluster\n)\n</pre></div>\n</div>\n<p>If you do not have a cluster up, but have cloud credentials (e.g.\u00a0aws,\ngcp, azure) for launching clusters or a Kubernetes cluster, you can set\nup and launch an on-demand cluster with <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.ondemand_cluster</span></code>. This\nuses SkyPilot under the hood, so run <code class=\"docutils literal notranslate\"><span class=\"pre\">sky</span> <span class=\"pre\">check</span></code> in a CLI first to\nmake sure credentials are set up properly.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster = rh.ondemand_cluster(\n    name=&quot;rh-cluster&quot;,\n    instance_type=&quot;CPU:2+&quot;,\n    provider=&quot;aws&quot;\n)\ncluster.up_if_not()\n\n# terminate this cluster with `cluster.teardown()` in Python, or `sky down rh-cluster` in CLI\n</pre></div>\n</div>\n<p>There are a number of options to specify the resources more finely, such\nas GPUs (<code class=\"docutils literal notranslate\"><span class=\"pre\">instance_type=&quot;A10G:4&quot;</span></code>), cloud provider names\n(<code class=\"docutils literal notranslate\"><span class=\"pre\">instance_type=&quot;m5.xlarge&quot;</span></code>), <code class=\"docutils literal notranslate\"><span class=\"pre\">num_instances=n</span></code> for multiple\ninstances, <code class=\"docutils literal notranslate\"><span class=\"pre\">memory</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">disk_size</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">region</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">image_id</span></code>,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">open_ports</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">spot</span></code>, and more. See the <a class=\"reference external\" href=\"https://www.run.house/docs/api/python/cluster#runhouse.ondemand_cluster\">on_demand_cluster\ndocs</a>.\nYou can also omit the provider argument to allocate from the cheapest\navailable source for which you have credentials.</p>\n</section>\n<section id=\"deployment\">\n<h2>Deployment<a class=\"headerlink\" href=\"#deployment\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>Simply wrap the function in <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.function</span></code> and send it to the cluster\nwith <code class=\"docutils literal notranslate\"><span class=\"pre\">.to</span></code>. This deploys the function to the cluster as a proper\nservice by syncing over the code, setting up any specified dependencies\n(see <code class=\"docutils literal notranslate\"><span class=\"pre\">Envs</span></code>), and importing and serving it in the Runhouse API server.\nWe\u2019re connected via an SSH tunnel here, so the service is secure, but we\ncan also open ports and secure it with Runhouse\u2019s out-of-the-box\nauthentication and HTTPS.</p>\n<p>Classes, or <code class=\"docutils literal notranslate\"><span class=\"pre\">Modules</span></code> are also supported, opening up a world of\npossibilities through persistent state. <code class=\"docutils literal notranslate\"><span class=\"pre\">Envs</span></code> allow you to specify\nthe environment in which the function or class is served, such as\ndependencies, environment variables, secrets, conda environments, and\nmore, and allow you to easily achieve powerful parallelism across the\ncluster. These are covered in more detail in the API tutorials.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>remote_get_platform = rh.function(get_platform).to(cluster)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span>INFO | 2024-05-16 03:20:53.066103 | Because this function is defined in a notebook, writing it out to /Users/donny/code/notebooks/docs/get_platform_fn.py to make it importable. Please make sure the function does not rely on any local variables, including imports (which should be moved inside the function body). This restriction does not apply to functions defined in normal Python files.\nINFO | 2024-05-16 03:20:53.079931 | Port 32300 is already in use. Trying next port.\nINFO | 2024-05-16 03:20:53.081995 | Forwarding port 32301 to port 32300 on localhost.\nINFO | 2024-05-16 03:20:54.215570 | Server rh-cluster is up.\nINFO | 2024-05-16 03:20:54.224806 | Copying package from file:///Users/donny/code/notebooks to: rh-cluster\nINFO | 2024-05-16 03:20:55.395007 | Calling _cluster_default_env.install\nINFO | 2024-05-16 03:20:55.948421 | Time to call _cluster_default_env.install: 0.55 seconds\nINFO | 2024-05-16 03:20:55.960756 | Sending module get_platform of type &lt;class &#39;runhouse.resources.functions.function.Function&#39;&gt; to rh-cluster\n</pre></div>\n</div>\n<p>The function we defined above, <code class=\"docutils literal notranslate\"><span class=\"pre\">get_platform</span></code>, now exists remotely on\nthe cluster, and can be called remotely using <code class=\"docutils literal notranslate\"><span class=\"pre\">remote_fn</span></code>. You can\ncall this remote function just as you would any other Python function,\nwith <code class=\"docutils literal notranslate\"><span class=\"pre\">remote_fn()</span></code>, and it runs on the cluster and returns the result\nto our local environment.</p>\n<p>Below, we run both the local and remote versions of this function, which\ngive different results and confirms that the functions are indeed being\nrun on different processes.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>print(f&quot;Local Platform: {get_platform()}&quot;)\nprint(f&quot;Remote Platform: {remote_get_platform()}&quot;)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">16</span> <span class=\"mi\">03</span><span class=\"p\">:</span><span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mf\">03.941205</span> <span class=\"o\">|</span> <span class=\"n\">Calling</span> <span class=\"n\">get_platform</span><span class=\"o\">.</span><span class=\"n\">call</span>\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">Local</span> <span class=\"n\">Platform</span><span class=\"p\">:</span> <span class=\"n\">macOS</span><span class=\"o\">-</span><span class=\"mf\">14.4.1</span><span class=\"o\">-</span><span class=\"n\">arm64</span><span class=\"o\">-</span><span class=\"n\">arm</span><span class=\"o\">-</span><span class=\"mi\">64</span><span class=\"n\">bit</span>\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">16</span> <span class=\"mi\">03</span><span class=\"p\">:</span><span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mf\">04.513689</span> <span class=\"o\">|</span> <span class=\"n\">Time</span> <span class=\"n\">to</span> <span class=\"n\">call</span> <span class=\"n\">get_platform</span><span class=\"o\">.</span><span class=\"n\">call</span><span class=\"p\">:</span> <span class=\"mf\">0.57</span> <span class=\"n\">seconds</span>\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">Remote</span> <span class=\"n\">Platform</span><span class=\"p\">:</span> <span class=\"n\">Linux</span><span class=\"o\">-</span><span class=\"mf\">5.15.0</span><span class=\"o\">-</span><span class=\"mi\">1049</span><span class=\"o\">-</span><span class=\"n\">aws</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"k\">with</span><span class=\"o\">-</span><span class=\"n\">glibc2</span><span class=\"mf\">.31</span>\n</pre></div>\n</div>\n<p>If you launched an on-demand cluster, you can terminate it by calling\n<code class=\"docutils literal notranslate\"><span class=\"pre\">cluster.teardown()</span></code>.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster.teardown()\n</pre></div>\n</div>\n</section>\n<section id=\"dive-deeper\">\n<h2>Dive Deeper<a class=\"headerlink\" href=\"#dive-deeper\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>What we just did, running a locally defined function on remote compute,\nis just the tip of the iceberg of what\u2019s possible with Runhouse. With a\nlarge suite of even more abstractions and features, Runhouse lets you\nquickly and seamlessly integrate between local and remote environments.</p>\n<p>To learn more, please take a look at our other tutorials, or at the <a class=\"reference external\" href=\"https://www.run.house/docs/api/python\">API\nreference</a></p>\n</section>\n</section>\n\n    <script type=\"text/x-thebe-config\">\n    {\n        requestKernel: true,\n        binderOptions: {\n            repo: \"binder-examples/jupyter-stacks-datascience\",\n            ref: \"master\",\n        },\n        codeMirrorConfig: {\n            theme: \"abcdef\",\n            mode: \"python\"\n        },\n        kernelOptions: {\n            name: \"python3\",\n            path: \"./tutorials\"\n        },\n        predefinedOutput: true\n    }\n    </script>\n    <script>kernelName = 'python3'</script>", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["tutorials/quick-start-local", "Local Quick Start", "N", "next"], ["index", "\ud83c\udfc3\u200d\u2640\ufe0f Runhouse Docs \ud83c\udfe0", "P", "previous"]], "sourcename": "tutorials/quick-start-cloud.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Cloud Quick Start</a><ul>\n<li><a class=\"reference internal\" href=\"#installing-runhouse\">Installing Runhouse</a></li>\n<li><a class=\"reference internal\" href=\"#local-python-function\">Local Python Function</a></li>\n<li><a class=\"reference internal\" href=\"#runhouse-cluster\">Runhouse Cluster</a></li>\n<li><a class=\"reference internal\" href=\"#deployment\">Deployment</a></li>\n<li><a class=\"reference internal\" href=\"#dive-deeper\">Dive Deeper</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "globaltoc": "<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Getting Started</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick-start-cloud/\">Cloud Quick Start</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick-start-local/\">Local Quick Start</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick-start-den/\">Den Quick Start</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">API Basics</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-clusters/\">Clusters</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-modules/\">Functions and Modules</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-envs/\">Envs and Packages</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-folders/\">Folders</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-secrets/\">Secrets</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-resources/\">Resource Management</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">API Reference</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/python/\">Python API</a><ul>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/resource/\">Resource</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/function/\">Function</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/cluster/\">Cluster</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/env/\">Env</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/package/\">Package</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/module/\">Module</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/mapper/\">Mapper</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/folder/\">Folder</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/table/\">Table</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/blob/\">Blob</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/file/\">File</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/secrets/\">Secrets</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/login/\">Login/Logout</a></li>\n</ul>\n</li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/cli/\">Command Line Interface</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Other Topics</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/async/\">Asynchronous Programming</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"architecture/\">Architecture Overview</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"installation/\">Installation and Setup</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"debugging-logging/\">Debugging and Logging</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"docker/\">Docker Runtime Env</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"troubleshooting/\">Manual Setup and Troubleshooting</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"security-and-authentication/\">Security and Authentication</a></li>\n</ul>\n", "current_page_name": "tutorials/quick-start-cloud", "sidebars": ["about.html", "navigation.html", "relations.html", "searchbox.html", "donate.html"], "customsidebar": null, "alabaster_version": "0.7.16", "alabaster_version_info": [0, 7, 16]}