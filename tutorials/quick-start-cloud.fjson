{"parents": [], "prev": {"link": "../quick-start-den/", "title": "Setting Up Runhouse"}, "next": {"link": "../../runhouse-in-your-stack/", "title": "Working with Common Libraries and Tools"}, "title": "API Quick Start", "meta": {}, "body": "<section id=\"api-quick-start\">\n<h1>API Quick Start<a class=\"headerlink\" href=\"#api-quick-start\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p><a href=\"https://colab.research.google.com/github/run-house/notebooks/blob/stable/docs/quick-start-cloud.ipynb\">\n<img height=\"20px\" width=\"117px\" src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a></p><p>This tutorial demonstrates how to use Runhouse to:</p>\n<ul class=\"simple\">\n<li><p>Launch a Runhouse cluster from elastic compute</p></li>\n<li><p>Send a locally defined function onto the remote compute and call it as\na service</p></li>\n</ul>\n<p>Runhouse lets you serverlessly dispatch and execute regular Python. This\nenables rapid, local-like development and iteration from your local IDE\nwhile executing on powerful remote compute. Then, identically execute\nyour code in production simply by scheduling the code to launch compute\nand dispatch to it, but without any need to change the underlying\nprogram code.</p>\n<p>We assume you have already installed and set up Runhouse according to\nthe <a class=\"reference external\" href=\"https://www.run.house/docs/tutorials/quick-start-den\">setup\nguide</a>.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>import runhouse as rh\nrh.login(&#39;your token&#39;) # From https://www.run.house/account if not logged in via CLI command `runhouse login` already\n</pre></div>\n</div>\n<section id=\"local-python-function\">\n<h2>Local Python Function<a class=\"headerlink\" href=\"#local-python-function\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>First, let\u2019s define the function that we want to be run on our remote\ncompute. This is just a regular Python function; no decorators,\nwrappers, or configs are necessary.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>def get_platform(a = 0):\n    import platform\n    return platform.platform()\n</pre></div>\n</div>\n</section>\n<section id=\"runhouse-cluster\">\n<h2>Runhouse Cluster<a class=\"headerlink\" href=\"#runhouse-cluster\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>In Runhouse, a \u201ccluster\u201d is a unit of compute, somewhere you can send\ncode, data, or requests to execute. We define a Runhouse cluster using\nthe <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.cluster</span></code> factory function.</p>\n<p>This requires having access to an existing VM (via SSH), a cloud\nprovider account to launch elastic compute, or a Kubernetes cluster.\nHere, we will launch an on-demand cluster using elastic compute. As\nnoted above, if you have not already enabled launching with Runhouse,\nyou should review <a class=\"reference external\" href=\"https://www.run.house/docs/tutorials/quick-start-den\">Setting Up\nRunhouse</a>.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster = rh.ondemand_cluster(\n    name=&quot;rh-cluster&quot;,\n    num_cpus=&quot;4&quot;,\n    provider=&quot;aws&quot;, # gcp, kubernetes, etc.\n    launcher=&quot;den&quot; # Switch to `local` if you are using Runhouse to launch from your local machine via Skypilot\n)\ncluster.up_if_not()\n</pre></div>\n</div>\n<p>There are a number of options to specify the resources more finely, such\nas GPUs (<code class=\"docutils literal notranslate\"><span class=\"pre\">accelerators=&quot;A10G:4&quot;</span></code>), cloud provider names\n(<code class=\"docutils literal notranslate\"><span class=\"pre\">instance_type=&quot;m5.xlarge&quot;</span></code>), <code class=\"docutils literal notranslate\"><span class=\"pre\">num_nodes=n</span></code> for multiple instances,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">memory</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">disk_size</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">region</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">use_spot</span></code>, and more. See the\n<a class=\"reference external\" href=\"https://www.run.house/docs/api/python/cluster#runhouse.ondemand_cluster\">on_demand_cluster\ndocs</a>.</p>\n<p>To use a cluster that\u2019s already running:</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster = rh.cluster(\n    name=&quot;rh-cluster&quot;,\n    host=&quot;example-cluster&quot;,  # hostname or ip address,\n    ssh_creds={&quot;ssh_user&quot;: &quot;ubuntu&quot;, &quot;ssh_private_key&quot;: &quot;~/.ssh/id_rsa&quot;},  # credentials for ssh-ing into the cluster\n)\n</pre></div>\n</div>\n</section>\n<section id=\"deploy-code-to-the-cluster\">\n<h2>Deploy Code to the Cluster<a class=\"headerlink\" href=\"#deploy-code-to-the-cluster\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>Simply wrap the function in <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.function</span></code> and send it to the cluster\nwith <code class=\"docutils literal notranslate\"><span class=\"pre\">.to</span></code>. This deploys the function to the cluster as a service by\nsyncing over the code, importing the synced code, and serving it in the\nRunhouse API server.</p>\n<p>Classes, or <code class=\"docutils literal notranslate\"><span class=\"pre\">Modules</span></code> are also supported. Remote instances of a remote\nclass have persisted state, enabling powerful usage patterns.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>remote_get_platform = rh.function(get_platform).to(cluster)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span>INFO | 2024-05-16 03:20:53.066103 | Because this function is defined in a notebook, writing it out to /Users/donny/code/notebooks/docs/get_platform_fn.py to make it importable. Please make sure the function does not rely on any local variables, including imports (which should be moved inside the function body). This restriction does not apply to functions defined in normal Python files.\nINFO | 2024-05-16 03:20:53.079931 | Port 32300 is already in use. Trying next port.\nINFO | 2024-05-16 03:20:53.081995 | Forwarding port 32301 to port 32300 on localhost.\nINFO | 2024-05-16 03:20:54.215570 | Server rh-cluster is up.\nINFO | 2024-05-16 03:20:54.224806 | Copying package from file:///Users/donny/code/notebooks to: rh-cluster\nINFO | 2024-05-16 03:20:55.395007 | Calling _cluster_default_env.install\nINFO | 2024-05-16 03:20:55.948421 | Time to call _cluster_default_env.install: 0.55 seconds\nINFO | 2024-05-16 03:20:55.960756 | Sending module get_platform of type &lt;class &#39;runhouse.resources.functions.function.Function&#39;&gt; to rh-cluster\n</pre></div>\n</div>\n<p>Deploying the function to the cluster took ~2 seconds, and the function\nwe defined above, <code class=\"docutils literal notranslate\"><span class=\"pre\">get_platform</span></code>, now exists remotely on the cluster,\nand can be called remotely using <code class=\"docutils literal notranslate\"><span class=\"pre\">remote_fn</span></code>. You can call this remote\nfunction normally from local, with <code class=\"docutils literal notranslate\"><span class=\"pre\">remote_fn()</span></code>, and it runs on the\ncluster and returns the result to our local environment.</p>\n<p>When we run the local and remote versions of this function, you see\ndifferent results based on where it executes.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>print(f&quot;Local Platform: {get_platform()}&quot;)\nprint(f&quot;Remote Platform: {remote_get_platform()}&quot;)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">16</span> <span class=\"mi\">03</span><span class=\"p\">:</span><span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mf\">03.941205</span> <span class=\"o\">|</span> <span class=\"n\">Calling</span> <span class=\"n\">get_platform</span><span class=\"o\">.</span><span class=\"n\">call</span>\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">Local</span> <span class=\"n\">Platform</span><span class=\"p\">:</span> <span class=\"n\">macOS</span><span class=\"o\">-</span><span class=\"mf\">14.4.1</span><span class=\"o\">-</span><span class=\"n\">arm64</span><span class=\"o\">-</span><span class=\"n\">arm</span><span class=\"o\">-</span><span class=\"mi\">64</span><span class=\"n\">bit</span>\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">16</span> <span class=\"mi\">03</span><span class=\"p\">:</span><span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mf\">04.513689</span> <span class=\"o\">|</span> <span class=\"n\">Time</span> <span class=\"n\">to</span> <span class=\"n\">call</span> <span class=\"n\">get_platform</span><span class=\"o\">.</span><span class=\"n\">call</span><span class=\"p\">:</span> <span class=\"mf\">0.57</span> <span class=\"n\">seconds</span>\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">Remote</span> <span class=\"n\">Platform</span><span class=\"p\">:</span> <span class=\"n\">Linux</span><span class=\"o\">-</span><span class=\"mf\">5.15.0</span><span class=\"o\">-</span><span class=\"mi\">1049</span><span class=\"o\">-</span><span class=\"n\">aws</span><span class=\"o\">-</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"k\">with</span><span class=\"o\">-</span><span class=\"n\">glibc2</span><span class=\"mf\">.31</span>\n</pre></div>\n</div>\n</section>\n<section id=\"saving-and-reloading\">\n<h2>Saving and Reloading<a class=\"headerlink\" href=\"#saving-and-reloading\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>You can save the resources we created above to your Runhouse account\nwith the <code class=\"docutils literal notranslate\"><span class=\"pre\">.save()</span></code> method.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>remote_get_platform.save()\ncluster.save() # Clusters are automatically be saved by Runhouse\n</pre></div>\n</div>\n<p>Once saved, resources can be reloaded from any environment in which you\nare logged into. For instance, if you are running this in a Colab\nnotebook, you can jump into your terminal, call <code class=\"docutils literal notranslate\"><span class=\"pre\">runhouse</span> <span class=\"pre\">login</span></code>, and\nthen reconstruct and run the function on the cluster with the following\nPython script:</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>import runhouse as rh\n\nif __name__ == &quot;__main__&quot;:\n    reloaded_fn = rh.function(name=&quot;get_platform&quot;)\n    print(reloaded_fn())\n</pre></div>\n</div>\n<p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">name</span></code> used to reload the function is the method name by default.\nYou can customize a function name using the following syntax:</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>remote_get_platform = rh.function(fn=get_platform, name=&quot;my_function&quot;).to(cluster)\n</pre></div>\n</div>\n</section>\n<section id=\"sharing\">\n<h2>Sharing<a class=\"headerlink\" href=\"#sharing\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>You can also share your resource with collaborators, and choose which\nlevel of access to give. Once shared, they will be able to see the\nresource in their dashboard as well, and be able to load and use the\nshared resource. They\u2019ll need to load the resource using its full name,\nwhich includes your username (<code class=\"docutils literal notranslate\"><span class=\"pre\">/your_username/get_platform</span></code>).</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>remote_get_platform.share(\n    users=[&quot;teammate1@email.com&quot;],\n    access_level=&quot;write&quot;,\n)\n</pre></div>\n</div>\n</section>\n<section id=\"web-ui\">\n<h2>Web UI<a class=\"headerlink\" href=\"#web-ui\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>After saving your resources, you can log in and see them on your <a class=\"reference external\" href=\"https://www.run.house/dashboard\">Den\ndashboard</a>, labeled as\n<code class=\"docutils literal notranslate\"><span class=\"pre\">/&lt;username&gt;/rh-cluster</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">/&lt;username&gt;/get_platform</span></code>.</p>\n<p>Clicking into the resource provides information about your resource. You\ncan view the resource metadata, previous versions, and activity, or add\na description to the resource.</p>\n</section>\n<section id=\"teardown\">\n<h2>Teardown<a class=\"headerlink\" href=\"#teardown\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>If you launched an on-demand cluster, you can terminate it by calling\n<code class=\"docutils literal notranslate\"><span class=\"pre\">cluster.teardown()</span></code>.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>cluster.teardown()\n</pre></div>\n</div>\n</section>\n<section id=\"dive-deeper\">\n<h2>Dive Deeper<a class=\"headerlink\" href=\"#dive-deeper\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>What we just did, running a locally defined function on remote compute,\nis just the tip of the iceberg of what\u2019s possible with Runhouse. With a\nlarge suite of even more abstractions and features, Runhouse lets you\nquickly and seamlessly integrate between local and remote environments.</p>\n<p>We recommend you now review the <a class=\"reference external\" href=\"https://www.run.house/docs/tutorials/quick-start-cloud\">extended guide on getting\nstarted</a> with\nRunhouse. You can also take a look at our\n<a class=\"reference external\" href=\"https://www.run.house/examples\">examples</a> or at the <a class=\"reference external\" href=\"https://www.run.house/docs/api/python\">API\nreference</a></p>\n</section>\n</section>\n\n    <script type=\"text/x-thebe-config\">\n    {\n        requestKernel: true,\n        binderOptions: {\n            repo: \"binder-examples/jupyter-stacks-datascience\",\n            ref: \"master\",\n        },\n        codeMirrorConfig: {\n            theme: \"abcdef\",\n            mode: \"python\"\n        },\n        kernelOptions: {\n            name: \"python3\",\n            path: \"./tutorials\"\n        },\n        predefinedOutput: true\n    }\n    </script>\n    <script>kernelName = 'python3'</script>", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["runhouse-in-your-stack", "Working with Common Libraries and Tools", "N", "next"], ["tutorials/quick-start-den", "Setting Up Runhouse", "P", "previous"]], "sourcename": "tutorials/quick-start-cloud.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">API Quick Start</a><ul>\n<li><a class=\"reference internal\" href=\"#local-python-function\">Local Python Function</a></li>\n<li><a class=\"reference internal\" href=\"#runhouse-cluster\">Runhouse Cluster</a></li>\n<li><a class=\"reference internal\" href=\"#deploy-code-to-the-cluster\">Deploy Code to the Cluster</a></li>\n<li><a class=\"reference internal\" href=\"#saving-and-reloading\">Saving and Reloading</a></li>\n<li><a class=\"reference internal\" href=\"#sharing\">Sharing</a></li>\n<li><a class=\"reference internal\" href=\"#web-ui\">Web UI</a></li>\n<li><a class=\"reference internal\" href=\"#teardown\">Teardown</a></li>\n<li><a class=\"reference internal\" href=\"#dive-deeper\">Dive Deeper</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "globaltoc": "<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Getting Started</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"how-to-use-runhouse/\">How to Use Runhouse</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick-start-den/\">Setting Up Runhouse</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick-start-cloud/\">API Quick Start</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"runhouse-in-your-stack/\">Working with Common Libraries and Tools</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">API Basics</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-clusters/\">Clusters</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-modules/\">Functions and Modules</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-process/\">Processes</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-images/\">Images</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-folders/\">Folders</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-secrets/\">Secrets</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-resources/\">Resource Management</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">API Reference</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/python/\">Python API</a><ul>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/resource/\">Resource</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/function/\">Function</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/cluster/\">Cluster</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/image/\">Image</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/package/\">Package</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/module/\">Module</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/folder/\">Folder</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/secrets/\">Secrets</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/login/\">Login/Logout</a></li>\n</ul>\n</li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/cli/\">Command Line Interface</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Other Topics</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/async/\">Asynchronous Programming</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"installation/\">Installation and Setup</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"debugging-logging/\">Debugging and Logging</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"docker-setup/\">Docker: Cluster Setup</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"docker-workflows/\">Docker: Dev and Prod Workflows with Runhouse</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"security-and-authentication/\">Security and Authentication</a></li>\n</ul>\n", "current_page_name": "tutorials/quick-start-cloud", "sidebars": ["about.html", "navigation.html", "relations.html", "searchbox.html", "donate.html"], "customsidebar": null, "alabaster_version": "0.7.16", "alabaster_version_info": [0, 7, 16]}