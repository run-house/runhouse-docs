{"parents": [], "prev": {"link": "../quick-start-cloud/", "title": "Cloud Quick Start"}, "next": {"link": "../quick-start-den/", "title": "Den Quick Start"}, "title": "Local Quick Start", "meta": {}, "body": "<section id=\"local-quick-start\">\n<h1>Local Quick Start<a class=\"headerlink\" href=\"#local-quick-start\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p><a href=\"https://colab.research.google.com/github/run-house/notebooks/blob/stable/docs/quick-start-local.ipynb\">\n<img height=\"20px\" width=\"117px\" src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a></p><p>In <a class=\"reference external\" href=\"https://www.run.house/docs/tutorials/quick-start-cloud\">Cloud Quick Start</a>,\nwe demonstrate how to deploy a local function to a remote cluster using\nRunhouse. In this local-only version, we show how to use Runhouse to set\nup a local web server, and deploy an arbitrary Python function to it.</p>\n<section id=\"runhouse-server-setup\">\n<h2>Runhouse Server Setup<a class=\"headerlink\" href=\"#runhouse-server-setup\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>First install Runhouse with <code class=\"docutils literal notranslate\"><span class=\"pre\">pip</span> <span class=\"pre\">install</span> <span class=\"pre\">runhouse</span></code></p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!pip install runhouse\n</pre></div>\n</div>\n<p>Next, start the Runhouse server locally on CLI with\n<code class=\"docutils literal notranslate\"><span class=\"pre\">runhouse</span> <span class=\"pre\">restart</span></code>, and use <code class=\"docutils literal notranslate\"><span class=\"pre\">runhouse</span> <span class=\"pre\">status</span></code> to print the status\nand details of the server. For printing cluster\u2019s status outside the cluser, its name should provided as well: <code class=\"docutils literal notranslate\"><span class=\"pre\">runhouse</span> <span class=\"pre\">status</span> <span class=\"pre\">&lt;cluster_name&gt;</span></code>.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!runhouse restart\n</pre></div>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!runhouse status\n</pre></div>\n</div>\n<p><em>CPU cluster</em></p>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span>/sashab/rh-basic-cpu\n\ud83d\ude08 Runhouse Daemon is running \ud83c\udfc3\nRunhouse v0.0.28\nserver pid: 29395\n\u2022 server port: 32300\n\u2022 den auth: True\n\u2022 server connection type: ssh\n\u2022 backend config:\n  \u2022 resource subtype: OnDemandCluster\n  \u2022 use local telemetry: False\n  \u2022 domain: None\n  \u2022 server host: 0.0.0.0\n  \u2022 ips: [&#39;52.207.212.159&#39;]\n  \u2022 resource subtype: OnDemandCluster\n  \u2022 autostop mins: autostop disabled\nServing \ud83c\udf66 :\n\u2022 _cluster_default_env (runhouse.Env)\n  This environment has only python packages installed, if such provided. No resources were found.\n\u2022 sd_env (runhouse.Env) | pid: 29716 | node: head (52.207.212.159)\n  CPU: 0.0% | Memory: 0.13 / 8 Gb (1.65%)\n  This environment has only python packages installed, if such provided. No resources were found.\n\u2022 np_pd_env (runhouse.Env) | pid: 29578 | node: head (52.207.212.159)\n  CPU: 0.0% | Memory: 0.13 / 8 Gb (1.71%)\n  \u2022 /sashab/summer (runhouse.Function)\n  \u2022 mult (runhouse.Function)\n</pre></div>\n</div>\n<p><em>GPU cluster</em></p>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span>/sashab/rh-basic-gpu\n\ud83d\ude08 Runhouse Daemon is running \ud83c\udfc3\nRunhouse v0.0.28\nserver pid: 29486\n\u2022 server port: 32300\n\u2022 den auth: True\n\u2022 server connection type: ssh\n\u2022 backend config:\n  \u2022 resource subtype: OnDemandCluster\n  \u2022 use local telemetry: False\n  \u2022 domain: None\n  \u2022 server host: 0.0.0.0\n  \u2022 ips: [&#39;35.171.157.49&#39;]\n  \u2022 resource subtype: OnDemandCluster\n  \u2022 autostop mins: autostop disabled\nServing \ud83c\udf66 :\n\u2022 _cluster_default_env (runhouse.Env)\n  This environment has only python packages installed, if such provided. No resources were found.\n\u2022 np_pd_env (runhouse.Env) | pid: 29672 | node: head (35.171.157.49)\n  CPU: 0.0% | Memory: 0.13 / 16 Gb (0.85%)\n  \u2022 /sashab/summer (runhouse.Function)\n  \u2022 mult (runhouse.Function)\n\u2022 sd_env (runhouse.Env) | pid: 29812 | node: head (35.171.157.49)\n  CPU: 1.0% | Memory: 4.47 / 16 Gb (28.95%)\n  GPU: 0.0% | Memory: 6.89 / 23 Gb (29.96%)\n  \u2022 sd_generate (runhouse.Function)\n</pre></div>\n</div>\n</section>\n<section id=\"local-python-function\">\n<h2>Local Python Function<a class=\"headerlink\" href=\"#local-python-function\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>Let\u2019s first define a simple Python function that we want to send to the\nserver. This function returns the process ID it runs on, and optionally\ntakes in a parameter, which it adds to the process ID prior to returning\nit.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>def get_pid(a=0):\n    import os\n    return os.getpid() + int(a)\n</pre></div>\n</div>\n</section>\n<section id=\"deployment\">\n<h2>Deployment<a class=\"headerlink\" href=\"#deployment\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>Standing up your Python code on the server is simple with the Runhouse\nAPI. Wrap the function with <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.function</span></code>, and then use\n<code class=\"docutils literal notranslate\"><span class=\"pre\">.to(rh.here)</span></code> to sync it to the server.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Make sure that any code in your Python file that\u2019s meant to only run\nlocally is placed within a <code class=\"docutils literal notranslate\"><span class=\"pre\">if</span> <span class=\"pre\">__name__</span> <span class=\"pre\">==</span> <span class=\"pre\">&quot;__main__&quot;:</span></code> block.\nOtherwise, that code will run when Runhouse attempts to import your\ncode remotely. For example, you wouldn\u2019t want\n<code class=\"docutils literal notranslate\"><span class=\"pre\">function.to(rh.here)</span></code> to run again on the server. This is not\nnecessary when using a notebook. Please see our <a class=\"reference external\" href=\"https://github.com/run-house/runhouse/tree/main/examples\">examples\ndirectory</a>\nfor implementation details.</p>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>import runhouse as rh\n</pre></div>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>server_fn = rh.function(get_pid).to(rh.here)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">26</span> <span class=\"mi\">22</span><span class=\"p\">:</span><span class=\"mi\">14</span><span class=\"p\">:</span><span class=\"mf\">53.460361</span> <span class=\"o\">|</span> <span class=\"n\">Because</span> <span class=\"n\">this</span> <span class=\"n\">function</span> <span class=\"ow\">is</span> <span class=\"n\">defined</span> <span class=\"ow\">in</span> <span class=\"n\">a</span> <span class=\"n\">notebook</span><span class=\"p\">,</span> <span class=\"n\">writing</span> <span class=\"n\">it</span> <span class=\"n\">out</span> <span class=\"n\">to</span> <span class=\"n\">a</span> <span class=\"n\">file</span> <span class=\"n\">to</span> <span class=\"n\">make</span> <span class=\"n\">it</span> <span class=\"n\">importable</span><span class=\"o\">.</span> <span class=\"n\">Please</span> <span class=\"n\">make</span> <span class=\"n\">sure</span> <span class=\"n\">the</span> <span class=\"n\">function</span> <span class=\"n\">does</span> <span class=\"ow\">not</span> <span class=\"n\">rely</span> <span class=\"n\">on</span> <span class=\"nb\">any</span> <span class=\"n\">local</span> <span class=\"n\">variables</span><span class=\"p\">,</span> <span class=\"n\">including</span> <span class=\"n\">imports</span> <span class=\"p\">(</span><span class=\"n\">which</span> <span class=\"n\">should</span> <span class=\"n\">be</span> <span class=\"n\">moved</span> <span class=\"n\">inside</span> <span class=\"n\">the</span> <span class=\"n\">function</span> <span class=\"n\">body</span><span class=\"p\">)</span><span class=\"o\">.</span> <span class=\"n\">Functions</span> <span class=\"n\">defined</span> <span class=\"ow\">in</span> <span class=\"n\">Python</span> <span class=\"n\">files</span> <span class=\"n\">can</span> <span class=\"n\">be</span> <span class=\"n\">used</span> <span class=\"n\">normally</span><span class=\"o\">.</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2024</span><span class=\"o\">-</span><span class=\"mi\">02</span><span class=\"o\">-</span><span class=\"mi\">26</span> <span class=\"mi\">22</span><span class=\"p\">:</span><span class=\"mi\">14</span><span class=\"p\">:</span><span class=\"mf\">53.523591</span> <span class=\"o\">|</span> <span class=\"n\">Sending</span> <span class=\"n\">module</span> <span class=\"n\">get_pid</span> <span class=\"n\">to</span> <span class=\"n\">local</span> <span class=\"n\">Runhouse</span> <span class=\"n\">daemon</span>\n</pre></div>\n</div>\n<p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">get_pid</span></code> function we defined above now exists on the server.</p>\n<section id=\"remote-function-call\">\n<h3>Remote Function Call<a class=\"headerlink\" href=\"#remote-function-call\" title=\"Permalink to this heading\">\u00b6</a></h3>\n<p>You can call the server function just as you would any other Python\nfunction, with <code class=\"docutils literal notranslate\"><span class=\"pre\">server_fn()</span></code>, and it runs on the server and returns\nthe result to our local environment.</p>\n<p>Below, we run both the local and server versions of this function, which\ngive different results and confirms that the functions are indeed being\nrun on different processes.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>print(f&quot;Local PID {get_pid()}&quot;)\nprint(f&quot;Server PID {server_fn()}&quot;)\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">Local</span> <span class=\"n\">PID</span> <span class=\"mi\">27818</span>\n<span class=\"n\">Server</span> <span class=\"n\">PID</span> <span class=\"mi\">19846</span>\n</pre></div>\n</div>\n</section>\n<section id=\"http-endpoint-and-curl\">\n<h3>HTTP Endpoint and Curl<a class=\"headerlink\" href=\"#http-endpoint-and-curl\" title=\"Permalink to this heading\">\u00b6</a></h3>\n<p>In addition to calling the function directly in Python, we can also\naccess it with a curl call or open it up in a browser.</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>server_fn.endpoint()\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"s1\">&#39;http://0.0.0.0:32300/get_pid&#39;</span>\n</pre></div>\n</div>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!curl &quot;http://0.0.0.0:32300/get_pid/call&quot;\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"p\">{</span><span class=\"s2\">&quot;data&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;19846&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;error&quot;</span><span class=\"p\">:</span><span class=\"n\">null</span><span class=\"p\">,</span><span class=\"s2\">&quot;traceback&quot;</span><span class=\"p\">:</span><span class=\"n\">null</span><span class=\"p\">,</span><span class=\"s2\">&quot;output_type&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;result_serialized&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;serialization&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;json&quot;</span><span class=\"p\">}</span>\n</pre></div>\n</div>\n<p>To pass in the optional function parameter:</p>\n<div class=\"highlight-ipython3 notranslate\"><div class=\"highlight\"><pre><span></span>!curl &quot;http://0.0.0.0:32300/get_pid/call?a=1&quot;\n</pre></div>\n</div>\n<div class=\"code-output highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"p\">{</span><span class=\"s2\">&quot;data&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;19847&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;error&quot;</span><span class=\"p\">:</span><span class=\"n\">null</span><span class=\"p\">,</span><span class=\"s2\">&quot;traceback&quot;</span><span class=\"p\">:</span><span class=\"n\">null</span><span class=\"p\">,</span><span class=\"s2\">&quot;output_type&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;result_serialized&quot;</span><span class=\"p\">,</span><span class=\"s2\">&quot;serialization&quot;</span><span class=\"p\">:</span><span class=\"s2\">&quot;json&quot;</span><span class=\"p\">}</span>\n</pre></div>\n</div>\n</section>\n</section>\n</section>\n\n    <script type=\"text/x-thebe-config\">\n    {\n        requestKernel: true,\n        binderOptions: {\n            repo: \"binder-examples/jupyter-stacks-datascience\",\n            ref: \"master\",\n        },\n        codeMirrorConfig: {\n            theme: \"abcdef\",\n            mode: \"python\"\n        },\n        kernelOptions: {\n            name: \"python3\",\n            path: \"./tutorials\"\n        },\n        predefinedOutput: true\n    }\n    </script>\n    <script>kernelName = 'python3'</script>", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["tutorials/quick-start-den", "Den Quick Start", "N", "next"], ["tutorials/quick-start-cloud", "Cloud Quick Start", "P", "previous"]], "sourcename": "tutorials/quick-start-local.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Local Quick Start</a><ul>\n<li><a class=\"reference internal\" href=\"#runhouse-server-setup\">Runhouse Server Setup</a></li>\n<li><a class=\"reference internal\" href=\"#local-python-function\">Local Python Function</a></li>\n<li><a class=\"reference internal\" href=\"#deployment\">Deployment</a><ul>\n<li><a class=\"reference internal\" href=\"#remote-function-call\">Remote Function Call</a></li>\n<li><a class=\"reference internal\" href=\"#http-endpoint-and-curl\">HTTP Endpoint and Curl</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "globaltoc": "<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Getting Started</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick-start-cloud/\">Cloud Quick Start</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick-start-local/\">Local Quick Start</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/quick-start-den/\">Den Quick Start</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">API Basics</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-clusters/\">Clusters</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-modules/\">Functions and Modules</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-envs/\">Envs and Packages</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-folders/\">Folders</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-secrets/\">Secrets</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/api-resources/\">Resource Management</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">API Reference</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/python/\">Python API</a><ul>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/resource/\">Resource</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/function/\">Function</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/cluster/\">Cluster</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/env/\">Env</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/package/\">Package</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/module/\">Module</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/mapper/\">Mapper</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/folder/\">Folder</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/table/\">Table</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/blob/\">Blob</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/file/\">File</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/secrets/\">Secrets</a></li>\n<li class=\"toctree-l2\"><a class=\"reference internal\" href=\"api/python/login/\">Login/Logout</a></li>\n</ul>\n</li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"api/cli/\">Command Line Interface</a></li>\n</ul>\n<p class=\"caption\" role=\"heading\"><span class=\"caption-text\">Other Topics</span></p>\n<ul>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"tutorials/async/\">Asynchronous Programming</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"architecture/\">Architecture Overview</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"installation/\">Installation and Setup</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"debugging-logging/\">Debugging and Logging</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"docker/\">Docker Runtime Env</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"troubleshooting/\">Manual Setup and Troubleshooting</a></li>\n<li class=\"toctree-l1\"><a class=\"reference internal\" href=\"security-and-authentication/\">Security and Authentication</a></li>\n</ul>\n", "current_page_name": "tutorials/quick-start-local", "sidebars": ["about.html", "navigation.html", "relations.html", "searchbox.html", "donate.html"], "customsidebar": null, "alabaster_version": "0.7.16", "alabaster_version_info": [0, 7, 16]}