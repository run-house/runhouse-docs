{"parents": [{"link": "../../../api_tutorials/", "title": "API Tutorials"}], "prev": {"link": "../compute/", "title": "Compute: Clusters, Functions, Packages, &amp; Envs"}, "next": {"link": "../accessibility/", "title": "Accessibility: Resource and Secrets Management"}, "title": "Data: Folders, Tables, &amp; Blobs", "meta": {}, "body": "<div class=\"section\" id=\"data-folders-tables-blobs\">\n<h1>Data: Folders, Tables, &amp; Blobs<a class=\"headerlink\" href=\"#data-folders-tables-blobs\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<p><a href=\"https://colab.research.google.com/github/run-house/runhouse/blob/stable/docs/notebooks/basics/data.ipynb\">\n<img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a></p><p>Runhouse has several abstractions to provide a simple interface for\nstoring, recalling, and moving data between the user\u2019s laptop, remote\ncompute, cloud storage, and specialized storage (e.g.\u00a0data warehouses).</p>\n<p>The Folder, Table, and Blob APIs provide least-common-denominator APIs\nacross providers, allowing users to easily specify the actions they want\nto take on the data without needed to dig into provider-specific APIs.</p>\n<div class=\"section\" id=\"install-runhouse-and-setup-cluster\">\n<h2>Install Runhouse and Setup Cluster<a class=\"headerlink\" href=\"#install-runhouse-and-setup-cluster\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span>!pip install runhouse[aws]\n</pre></div>\n</div>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">runhouse</span> <span class=\"k\">as</span> <span class=\"nn\">rh</span>\n</pre></div>\n</div>\n<p>Optionally, login to Runhouse to sync credentials.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span>!runhouse login\n</pre></div>\n</div>\n<p>We also construct a Runhouse cluster object that we will use throughout\nthe tutorial. We won\u2019t go in depth about clusters in this tutorial, but\nyou can refer to Getting Started for setup instructions, or the Compute\nAPI tutorial for a more in-depth walkthrough of clusters.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">cluster</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">ondemand_cluster</span><span class=\"p\">(</span>\n              <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s2\">&quot;cpu-cluster&quot;</span><span class=\"p\">,</span>\n              <span class=\"n\">instance_type</span><span class=\"o\">=</span><span class=\"s2\">&quot;CPU:8&quot;</span><span class=\"p\">,</span>\n              <span class=\"n\">provider</span><span class=\"o\">=</span><span class=\"s2\">&quot;cheapest&quot;</span><span class=\"p\">,</span>       <span class=\"c1\"># &quot;AWS&quot;, &quot;GCP&quot;, &quot;Azure&quot;, &quot;Lambda&quot;, or &quot;cheapest&quot; (default)</span>\n              <span class=\"n\">autostop_mins</span><span class=\"o\">=</span><span class=\"mi\">60</span><span class=\"p\">,</span>          <span class=\"c1\"># Optional, defaults to default_autostop_mins; -1 suspends autostop</span>\n          <span class=\"p\">)</span>\n<span class=\"n\">cluster</span><span class=\"o\">.</span><span class=\"n\">up</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n</div>\n<div class=\"section\" id=\"folders\">\n<h2>Folders<a class=\"headerlink\" href=\"#folders\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>The Runhouse Folder API allows for creating references to folders, and\nsyncing them between local, remote clusters, or file storage (S3, GS,\nAzure).</p>\n<p>Let\u2019s construct a sample dummy folder locally, that we\u2019ll use to\ndemonstrate.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">os</span>\n<span class=\"n\">folder_name</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;sample_folder&quot;</span>\n<span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">makedirs</span><span class=\"p\">(</span><span class=\"n\">folder_name</span><span class=\"p\">,</span> <span class=\"n\">exist_ok</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n\n<span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">):</span>\n  <span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"sa\">f</span><span class=\"s1\">&#39;</span><span class=\"si\">{</span><span class=\"n\">folder_name</span><span class=\"si\">}</span><span class=\"s1\">/</span><span class=\"si\">{</span><span class=\"n\">i</span><span class=\"si\">}</span><span class=\"s1\">.txt&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;w&#39;</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n      <span class=\"n\">f</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">(</span><span class=\"s1\">&#39;i&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">local_path</span> <span class=\"o\">=</span> <span class=\"sa\">f</span><span class=\"s2\">&quot;</span><span class=\"si\">{</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">getcwd</span><span class=\"p\">()</span><span class=\"si\">}</span><span class=\"s2\">/</span><span class=\"si\">{</span><span class=\"n\">folder_name</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span>\n</pre></div>\n</div>\n<p>To create a folder object, use the <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.folder()</span></code> factory function, and\nuse <code class=\"docutils literal notranslate\"><span class=\"pre\">.to()</span></code> to send the folder to a remote cluster.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">local_folder</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">folder</span><span class=\"p\">(</span><span class=\"n\">path</span><span class=\"o\">=</span><span class=\"sa\">f</span><span class=\"s2\">&quot;</span><span class=\"si\">{</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">getcwd</span><span class=\"p\">()</span><span class=\"si\">}</span><span class=\"s2\">/</span><span class=\"si\">{</span><span class=\"n\">folder_name</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">cluster_folder</span> <span class=\"o\">=</span> <span class=\"n\">local_folder</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">system</span><span class=\"o\">=</span><span class=\"n\">cluster</span><span class=\"p\">,</span> <span class=\"n\">path</span><span class=\"o\">=</span><span class=\"n\">folder_name</span><span class=\"p\">)</span>\n\n<span class=\"n\">cluster</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">([</span><span class=\"sa\">f</span><span class=\"s2\">&quot;ls </span><span class=\"si\">{</span><span class=\"n\">folder_name</span><span class=\"si\">}</span><span class=\"s2\">&quot;</span><span class=\"p\">])</span>\n</pre></div>\n</div>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">15</span><span class=\"p\">:</span><span class=\"mi\">23</span><span class=\"p\">,</span><span class=\"mi\">316</span> <span class=\"o\">|</span> <span class=\"n\">Creating</span> <span class=\"n\">new</span> <span class=\"n\">file</span> <span class=\"n\">folder</span> <span class=\"k\">if</span> <span class=\"n\">it</span> <span class=\"n\">does</span> <span class=\"ow\">not</span> <span class=\"n\">already</span> <span class=\"n\">exist</span> <span class=\"ow\">in</span> <span class=\"n\">path</span><span class=\"p\">:</span> <span class=\"o\">/</span><span class=\"n\">content</span><span class=\"o\">/</span><span class=\"n\">sample_folder</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">15</span><span class=\"p\">:</span><span class=\"mi\">23</span><span class=\"p\">,</span><span class=\"mi\">318</span> <span class=\"o\">|</span> <span class=\"n\">Copying</span> <span class=\"n\">folder</span> <span class=\"kn\">from</span> <span class=\"nn\">file</span><span class=\"p\">:</span><span class=\"o\">///</span><span class=\"n\">content</span><span class=\"o\">/</span><span class=\"n\">sample_folder</span> <span class=\"n\">to</span><span class=\"p\">:</span> <span class=\"n\">cpu</span><span class=\"o\">-</span><span class=\"n\">cluster</span><span class=\"p\">,</span> <span class=\"k\">with</span> <span class=\"n\">path</span><span class=\"p\">:</span> <span class=\"n\">sample_folder</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">15</span><span class=\"p\">:</span><span class=\"mi\">24</span><span class=\"p\">,</span><span class=\"mi\">766</span> <span class=\"o\">|</span> <span class=\"n\">Running</span> <span class=\"n\">command</span> <span class=\"n\">on</span> <span class=\"n\">cpu</span><span class=\"o\">-</span><span class=\"n\">cluster</span><span class=\"p\">:</span> <span class=\"n\">ls</span> <span class=\"n\">sample_folder</span>\n<span class=\"mf\">0.</span><span class=\"n\">txt</span>\n<span class=\"mf\">1.</span><span class=\"n\">txt</span>\n<span class=\"mf\">2.</span><span class=\"n\">txt</span>\n<span class=\"mf\">3.</span><span class=\"n\">txt</span>\n<span class=\"mf\">4.</span><span class=\"n\">txt</span>\n</pre></div>\n</div>\n<pre class=\"literal-block\">[(0, '0.txtn1.txtn2.txtn3.txtn4.txtn', '')]</pre>\n<p>You can also send the folder to file storage, such as S3, GS, and Azure.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">s3_folder</span> <span class=\"o\">=</span> <span class=\"n\">local_folder</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">system</span><span class=\"o\">=</span><span class=\"s2\">&quot;s3&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">s3_folder</span><span class=\"o\">.</span><span class=\"n\">ls</span><span class=\"p\">(</span><span class=\"n\">full_paths</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Similarly, you can send folders from a cluster to file storage, cluster\nto cluster, or file storage to file storage. These are all done without\nbouncing the folder off local.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">cluster_folder</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">system</span><span class=\"o\">=</span><span class=\"n\">another_cluster</span><span class=\"p\">)</span>  <span class=\"c1\"># cluster to cluster</span>\n<span class=\"n\">cluster_folder</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">system</span><span class=\"o\">=</span><span class=\"s2\">&quot;s3&quot;</span><span class=\"p\">)</span>             <span class=\"c1\"># cluster to fs</span>\n<span class=\"n\">s3_folder</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">system</span><span class=\"o\">=</span><span class=\"n\">cluster</span><span class=\"p\">)</span>               <span class=\"c1\"># fs to cluster</span>\n<span class=\"n\">s3_folder</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">system</span><span class=\"o\">=</span><span class=\"s2\">&quot;gs&quot;</span><span class=\"p\">)</span>                  <span class=\"c1\"># fs to fs</span>\n</pre></div>\n</div>\n</div>\n<div class=\"section\" id=\"tables\">\n<h2>Tables<a class=\"headerlink\" href=\"#tables\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>The Runhouse Table API allows for abstracting tabular data storage, and\nsupports interfaces for HuggingFace, Dask, Pandas, Rapids, and Ray\ntables (more in progress!).</p>\n<p>These can be synced and written down to local, remote clusters, or file\nstorage (S3, GS, Azure).</p>\n<p>Let\u2019s step through an example using Pandas tables:</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">pandas</span> <span class=\"k\">as</span> <span class=\"nn\">pd</span>\n<span class=\"n\">df</span> <span class=\"o\">=</span> <span class=\"n\">pd</span><span class=\"o\">.</span><span class=\"n\">DataFrame</span><span class=\"p\">(</span>\n        <span class=\"p\">{</span><span class=\"s2\">&quot;id&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">],</span> <span class=\"s2\">&quot;grade&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">&quot;a&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;b&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;b&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;a&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;a&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;e&quot;</span><span class=\"p\">]}</span>\n    <span class=\"p\">)</span>\n\n<span class=\"n\">table_name</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;sample_table&quot;</span>\n<span class=\"n\">rh_table</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">table</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"n\">df</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"n\">table_name</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">rh_table</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">49</span><span class=\"p\">:</span><span class=\"mi\">13</span><span class=\"p\">,</span><span class=\"mi\">620</span> <span class=\"o\">|</span> <span class=\"n\">Attempting</span> <span class=\"n\">to</span> <span class=\"n\">load</span> <span class=\"n\">config</span> <span class=\"k\">for</span> <span class=\"o\">/</span><span class=\"n\">carolineechen</span><span class=\"o\">/</span><span class=\"n\">file</span> <span class=\"kn\">from</span> <span class=\"nn\">RNS.</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">49</span><span class=\"p\">:</span><span class=\"mi\">13</span><span class=\"p\">,</span><span class=\"mi\">684</span> <span class=\"o\">|</span> <span class=\"n\">No</span> <span class=\"n\">config</span> <span class=\"n\">found</span> <span class=\"ow\">in</span> <span class=\"n\">RNS</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;detail&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Resource does not exist&#39;</span><span class=\"p\">}</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">49</span><span class=\"p\">:</span><span class=\"mi\">13</span><span class=\"p\">,</span><span class=\"mi\">687</span> <span class=\"o\">|</span> <span class=\"n\">Creating</span> <span class=\"n\">new</span> <span class=\"n\">file</span> <span class=\"n\">folder</span> <span class=\"k\">if</span> <span class=\"n\">it</span> <span class=\"n\">does</span> <span class=\"ow\">not</span> <span class=\"n\">already</span> <span class=\"n\">exist</span> <span class=\"ow\">in</span> <span class=\"n\">path</span><span class=\"p\">:</span> <span class=\"o\">/</span><span class=\"n\">root</span><span class=\"o\">/.</span><span class=\"n\">cache</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"n\">tables</span><span class=\"o\">/</span><span class=\"mi\">0</span><span class=\"n\">b9b0c0c5afc4d03b475db6ec61f7b7b</span>\n   <span class=\"nb\">id</span> <span class=\"n\">grade</span>\n<span class=\"mi\">0</span>   <span class=\"mi\">1</span>     <span class=\"n\">a</span>\n<span class=\"mi\">1</span>   <span class=\"mi\">2</span>     <span class=\"n\">b</span>\n<span class=\"mi\">2</span>   <span class=\"mi\">3</span>     <span class=\"n\">b</span>\n<span class=\"mi\">3</span>   <span class=\"mi\">4</span>     <span class=\"n\">a</span>\n<span class=\"mi\">4</span>   <span class=\"mi\">5</span>     <span class=\"n\">a</span>\n<span class=\"mi\">5</span>   <span class=\"mi\">6</span>     <span class=\"n\">e</span>\n</pre></div>\n</div>\n<p>To sync over and save the table to file storage, like S3, or to a remote\ncluster:</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">rh_table</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">system</span><span class=\"o\">=</span><span class=\"s2\">&quot;s3&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">rh_table</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">cluster</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>To stream batches of the table, we can create a new table object with an\niterable <code class=\"docutils literal notranslate\"><span class=\"pre\">.data</span></code> field using the <code class=\"docutils literal notranslate\"><span class=\"pre\">rh.table</span></code> constructor and passing\nin the name.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">reloaded_table</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">table</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"n\">table_name</span><span class=\"p\">)</span>\n<span class=\"n\">batches</span> <span class=\"o\">=</span> <span class=\"n\">reloaded_table</span><span class=\"o\">.</span><span class=\"n\">stream</span><span class=\"p\">(</span><span class=\"n\">batch_size</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"k\">for</span> <span class=\"n\">_</span><span class=\"p\">,</span> <span class=\"n\">batch</span> <span class=\"ow\">in</span> <span class=\"n\">batches</span><span class=\"p\">:</span>\n    <span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">batch</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</div>\n<div class=\"section\" id=\"blobs\">\n<h2>Blobs<a class=\"headerlink\" href=\"#blobs\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>The Runhouse Blob API represents an entity for storing arbitrary data.\nBlobs are associated with a system (local, remote, or file storage), and\ncan be written down or synced to systems.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">json</span>\n<span class=\"kn\">import</span> <span class=\"nn\">pickle</span>\n\n<span class=\"n\">blob_data</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">dumps</span><span class=\"p\">(</span><span class=\"n\">json</span><span class=\"o\">.</span><span class=\"n\">dumps</span><span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">50</span><span class=\"p\">))))</span>\n</pre></div>\n</div>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># create local blob and write contents to file</span>\n<span class=\"n\">local_blob</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">blob</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s2\">&quot;local_blob&quot;</span><span class=\"p\">,</span> <span class=\"n\">data</span><span class=\"o\">=</span><span class=\"n\">blob_data</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">()</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">loads</span><span class=\"p\">(</span><span class=\"n\">local_blob</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">))</span>\n\n<span class=\"c1\"># reload local blob</span>\n<span class=\"n\">reloaded_blob</span> <span class=\"o\">=</span> <span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">blob</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s2\">&quot;local_blob&quot;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">loads</span><span class=\"p\">(</span><span class=\"n\">reloaded_blob</span><span class=\"o\">.</span><span class=\"n\">fetch</span><span class=\"p\">()))</span>\n\n<span class=\"c1\"># to sync the blob to remote or fs</span>\n<span class=\"n\">local_blob</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">system</span><span class=\"o\">=</span><span class=\"n\">cluster</span><span class=\"p\">)</span>\n<span class=\"n\">local_blob</span><span class=\"o\">.</span><span class=\"n\">to</span><span class=\"p\">(</span><span class=\"n\">system</span><span class=\"o\">=</span><span class=\"s2\">&quot;s3&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">:</span><span class=\"mi\">29</span><span class=\"p\">,</span><span class=\"mi\">141</span> <span class=\"o\">|</span> <span class=\"n\">Attempting</span> <span class=\"n\">to</span> <span class=\"n\">load</span> <span class=\"n\">config</span> <span class=\"k\">for</span> <span class=\"o\">/</span><span class=\"n\">carolineechen</span><span class=\"o\">/</span><span class=\"n\">local_blob</span> <span class=\"kn\">from</span> <span class=\"nn\">RNS.</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">:</span><span class=\"mi\">29</span><span class=\"p\">,</span><span class=\"mi\">212</span> <span class=\"o\">|</span> <span class=\"n\">Attempting</span> <span class=\"n\">to</span> <span class=\"n\">load</span> <span class=\"n\">config</span> <span class=\"k\">for</span> <span class=\"o\">/</span><span class=\"n\">carolineechen</span><span class=\"o\">/</span><span class=\"n\">file</span> <span class=\"kn\">from</span> <span class=\"nn\">RNS.</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">:</span><span class=\"mi\">29</span><span class=\"p\">,</span><span class=\"mi\">267</span> <span class=\"o\">|</span> <span class=\"n\">No</span> <span class=\"n\">config</span> <span class=\"n\">found</span> <span class=\"ow\">in</span> <span class=\"n\">RNS</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;detail&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Resource does not exist&#39;</span><span class=\"p\">}</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">:</span><span class=\"mi\">29</span><span class=\"p\">,</span><span class=\"mi\">269</span> <span class=\"o\">|</span> <span class=\"n\">Creating</span> <span class=\"n\">new</span> <span class=\"n\">file</span> <span class=\"n\">folder</span> <span class=\"k\">if</span> <span class=\"n\">it</span> <span class=\"n\">does</span> <span class=\"ow\">not</span> <span class=\"n\">already</span> <span class=\"n\">exist</span> <span class=\"ow\">in</span> <span class=\"n\">path</span><span class=\"p\">:</span> <span class=\"o\">/</span><span class=\"n\">root</span><span class=\"o\">/.</span><span class=\"n\">cache</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"n\">blobs</span><span class=\"o\">/</span><span class=\"n\">aa9001761bb14d13bd3545b1f6127a6e</span><span class=\"o\">/</span><span class=\"n\">carolineechen</span>\n<span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">,</span> <span class=\"mi\">7</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"mi\">13</span><span class=\"p\">,</span> <span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">16</span><span class=\"p\">,</span> <span class=\"mi\">17</span><span class=\"p\">,</span> <span class=\"mi\">18</span><span class=\"p\">,</span> <span class=\"mi\">19</span><span class=\"p\">,</span> <span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"mi\">21</span><span class=\"p\">,</span> <span class=\"mi\">22</span><span class=\"p\">,</span> <span class=\"mi\">23</span><span class=\"p\">,</span> <span class=\"mi\">24</span><span class=\"p\">,</span> <span class=\"mi\">25</span><span class=\"p\">,</span> <span class=\"mi\">26</span><span class=\"p\">,</span> <span class=\"mi\">27</span><span class=\"p\">,</span> <span class=\"mi\">28</span><span class=\"p\">,</span> <span class=\"mi\">29</span><span class=\"p\">,</span> <span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"mi\">31</span><span class=\"p\">,</span> <span class=\"mi\">32</span><span class=\"p\">,</span> <span class=\"mi\">33</span><span class=\"p\">,</span> <span class=\"mi\">34</span><span class=\"p\">,</span> <span class=\"mi\">35</span><span class=\"p\">,</span> <span class=\"mi\">36</span><span class=\"p\">,</span> <span class=\"mi\">37</span><span class=\"p\">,</span> <span class=\"mi\">38</span><span class=\"p\">,</span> <span class=\"mi\">39</span><span class=\"p\">,</span> <span class=\"mi\">40</span><span class=\"p\">,</span> <span class=\"mi\">41</span><span class=\"p\">,</span> <span class=\"mi\">42</span><span class=\"p\">,</span> <span class=\"mi\">43</span><span class=\"p\">,</span> <span class=\"mi\">44</span><span class=\"p\">,</span> <span class=\"mi\">45</span><span class=\"p\">,</span> <span class=\"mi\">46</span><span class=\"p\">,</span> <span class=\"mi\">47</span><span class=\"p\">,</span> <span class=\"mi\">48</span><span class=\"p\">,</span> <span class=\"mi\">49</span><span class=\"p\">]</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">:</span><span class=\"mi\">29</span><span class=\"p\">,</span><span class=\"mi\">274</span> <span class=\"o\">|</span> <span class=\"n\">Attempting</span> <span class=\"n\">to</span> <span class=\"n\">load</span> <span class=\"n\">config</span> <span class=\"k\">for</span> <span class=\"o\">/</span><span class=\"n\">carolineechen</span><span class=\"o\">/</span><span class=\"n\">local_blob</span> <span class=\"kn\">from</span> <span class=\"nn\">RNS.</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">:</span><span class=\"mi\">29</span><span class=\"p\">,</span><span class=\"mi\">332</span> <span class=\"o\">|</span> <span class=\"n\">Attempting</span> <span class=\"n\">to</span> <span class=\"n\">load</span> <span class=\"n\">config</span> <span class=\"k\">for</span> <span class=\"o\">/</span><span class=\"n\">carolineechen</span><span class=\"o\">/</span><span class=\"n\">file</span> <span class=\"kn\">from</span> <span class=\"nn\">RNS.</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">:</span><span class=\"mi\">29</span><span class=\"p\">,</span><span class=\"mi\">388</span> <span class=\"o\">|</span> <span class=\"n\">No</span> <span class=\"n\">config</span> <span class=\"n\">found</span> <span class=\"ow\">in</span> <span class=\"n\">RNS</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"s1\">&#39;detail&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;Resource does not exist&#39;</span><span class=\"p\">}</span>\n<span class=\"n\">INFO</span> <span class=\"o\">|</span> <span class=\"mi\">2023</span><span class=\"o\">-</span><span class=\"mi\">05</span><span class=\"o\">-</span><span class=\"mi\">08</span> <span class=\"mi\">21</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">:</span><span class=\"mi\">29</span><span class=\"p\">,</span><span class=\"mi\">390</span> <span class=\"o\">|</span> <span class=\"n\">Creating</span> <span class=\"n\">new</span> <span class=\"n\">file</span> <span class=\"n\">folder</span> <span class=\"k\">if</span> <span class=\"n\">it</span> <span class=\"n\">does</span> <span class=\"ow\">not</span> <span class=\"n\">already</span> <span class=\"n\">exist</span> <span class=\"ow\">in</span> <span class=\"n\">path</span><span class=\"p\">:</span> <span class=\"o\">/</span><span class=\"n\">root</span><span class=\"o\">/.</span><span class=\"n\">cache</span><span class=\"o\">/</span><span class=\"n\">runhouse</span><span class=\"o\">/</span><span class=\"n\">blobs</span><span class=\"o\">/</span><span class=\"n\">aa9001761bb14d13bd3545b1f6127a6e</span><span class=\"o\">/</span><span class=\"n\">carolineechen</span>\n<span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">,</span> <span class=\"mi\">7</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">9</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"mi\">13</span><span class=\"p\">,</span> <span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">16</span><span class=\"p\">,</span> <span class=\"mi\">17</span><span class=\"p\">,</span> <span class=\"mi\">18</span><span class=\"p\">,</span> <span class=\"mi\">19</span><span class=\"p\">,</span> <span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"mi\">21</span><span class=\"p\">,</span> <span class=\"mi\">22</span><span class=\"p\">,</span> <span class=\"mi\">23</span><span class=\"p\">,</span> <span class=\"mi\">24</span><span class=\"p\">,</span> <span class=\"mi\">25</span><span class=\"p\">,</span> <span class=\"mi\">26</span><span class=\"p\">,</span> <span class=\"mi\">27</span><span class=\"p\">,</span> <span class=\"mi\">28</span><span class=\"p\">,</span> <span class=\"mi\">29</span><span class=\"p\">,</span> <span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"mi\">31</span><span class=\"p\">,</span> <span class=\"mi\">32</span><span class=\"p\">,</span> <span class=\"mi\">33</span><span class=\"p\">,</span> <span class=\"mi\">34</span><span class=\"p\">,</span> <span class=\"mi\">35</span><span class=\"p\">,</span> <span class=\"mi\">36</span><span class=\"p\">,</span> <span class=\"mi\">37</span><span class=\"p\">,</span> <span class=\"mi\">38</span><span class=\"p\">,</span> <span class=\"mi\">39</span><span class=\"p\">,</span> <span class=\"mi\">40</span><span class=\"p\">,</span> <span class=\"mi\">41</span><span class=\"p\">,</span> <span class=\"mi\">42</span><span class=\"p\">,</span> <span class=\"mi\">43</span><span class=\"p\">,</span> <span class=\"mi\">44</span><span class=\"p\">,</span> <span class=\"mi\">45</span><span class=\"p\">,</span> <span class=\"mi\">46</span><span class=\"p\">,</span> <span class=\"mi\">47</span><span class=\"p\">,</span> <span class=\"mi\">48</span><span class=\"p\">,</span> <span class=\"mi\">49</span><span class=\"p\">]</span>\n</pre></div>\n</div>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># create blob on s3</span>\n<span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">blob</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"n\">blob_data</span><span class=\"p\">,</span> <span class=\"n\">system</span><span class=\"o\">=</span><span class=\"s2\">&quot;s3&quot;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">write</span><span class=\"p\">()</span>\n\n<span class=\"c1\"># create blob from cluster</span>\n<span class=\"n\">rh</span><span class=\"o\">.</span><span class=\"n\">blob</span><span class=\"p\">(</span><span class=\"n\">path</span><span class=\"o\">=</span><span class=\"s2\">&quot;path/on/cluster&quot;</span><span class=\"p\">,</span> <span class=\"n\">system</span><span class=\"o\">=</span><span class=\"n\">cluster</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</div>\n<div class=\"section\" id=\"terminate-cluster\">\n<h2>Terminate Cluster<a class=\"headerlink\" href=\"#terminate-cluster\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span>!sky down cpu-cluster\n# or\ncluster.teardown()\n</pre></div>\n</div>\n</div>\n</div>\n\n    <script type=\"text/x-thebe-config\">\n    {\n        requestKernel: true,\n        binderOptions: {\n            repo: \"binder-examples/jupyter-stacks-datascience\",\n            ref: \"master\",\n        },\n        codeMirrorConfig: {\n            theme: \"abcdef\",\n            mode: \"python\"\n        },\n        kernelOptions: {\n            kernelName: \"python3\",\n            path: \"./tutorials/api\"\n        },\n        predefinedOutput: true\n    }\n    </script>\n    <script>kernelName = 'python3'</script>", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["tutorials/api/accessibility", "Accessibility: Resource and Secrets Management", "N", "next"], ["tutorials/api/compute", "Compute: Clusters, Functions, Packages, &amp; Envs", "P", "previous"]], "sourcename": "tutorials/api/data.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Data: Folders, Tables, &amp; Blobs</a><ul>\n<li><a class=\"reference internal\" href=\"#install-runhouse-and-setup-cluster\">Install Runhouse and Setup Cluster</a></li>\n<li><a class=\"reference internal\" href=\"#folders\">Folders</a></li>\n<li><a class=\"reference internal\" href=\"#tables\">Tables</a></li>\n<li><a class=\"reference internal\" href=\"#blobs\">Blobs</a></li>\n<li><a class=\"reference internal\" href=\"#terminate-cluster\">Terminate Cluster</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "tutorials/api/data", "sidebars": ["about.html", "navigation.html", "relations.html", "searchbox.html", "donate.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.12"}